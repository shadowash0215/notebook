<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="shad0wash 的笔记本" name="description"/>
<link href="https://note.shad0wash.cc/ads/Lec1/" rel="canonical"/>
<link href="../" rel="prev"/>
<link href="../Lec2/" rel="next"/>
<link href="../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.4.2, mkdocs-material-9.0.4" name="generator"/>
<title>AVL 树, Splay 树, 摊还分析 - shad0wash's notebook</title>
<link href="../../assets/stylesheets/main.9c788c91.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.2505c338.min.css" rel="stylesheet"/>
<link href="../../css/svg.css" rel="stylesheet"/>
<link href="../../css/heti.css" rel="stylesheet"/>
<link href="../../css/svg_extra.css" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" rel="stylesheet"/>
<link href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.1.0/style.css" rel="stylesheet"/>
<link href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css" rel="stylesheet"/>
<link href="../../css/stylesheet.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="" data-md-color-primary="" data-md-color-scheme="default" dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#avl">
          跳转至
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="页眉" class="md-header__inner md-grid">
<a aria-label="shad0wash's notebook" class="md-header__button md-logo" data-md-component="logo" href="../.." title="shad0wash's notebook">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            shad0wash's notebook
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              AVL 树, Splay 树, 摊还分析
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
</label>
</form>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="搜索" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="搜索" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="查找" class="md-search__options">
<button aria-label="清空当前内容" class="md-search__icon md-icon" tabindex="-1" title="清空当前内容" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/shadowash0215/notebook" title="前往仓库">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    shadowash/notebook
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="标签" class="md-tabs" data-md-component="tabs">
<div class="md-tabs__inner md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../..">
        Home
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link md-tabs__link--active" href="../../CSAPP/">
        Computer Science
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../math/">
        Math
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../crypto/">
        Crypto
      </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="导航栏" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="shad0wash's notebook" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="shad0wash's notebook">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
    shad0wash's notebook
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/shadowash0215/notebook" title="前往仓库">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    shadowash/notebook
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" id="__nav_1" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../..">Home</a>
<label for="__nav_1">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="Home" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
          Home
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../links/">
        友链喵
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" id="__nav_2" type="checkbox"/>
<label aria-expanded="true" class="md-nav__link" for="__nav_2" tabindex="0">
          Computer Science
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Computer Science" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          Computer Science
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" id="__nav_2_1" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../CSAPP/">CSAPP</a>
<label for="__nav_2_1">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="CSAPP" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_1">
<span class="md-nav__icon md-icon"></span>
          CSAPP
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../CSAPP/Chap1/">
        1 计算机系统漫游
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../CSAPP/Chap2/">
        2 信息的表示和处理
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../CSAPP/Chap3/">
        3 程序的机器级表示
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" id="__nav_2_2" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../fds/">fds</a>
<label for="__nav_2_2">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="fds" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_2">
<span class="md-nav__icon md-icon"></span>
          fds
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../fds/mistakes/">
        Mistakes Collection
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fds/linkedlist/">
        链表
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fds/stack_queue/">
        栈和队列
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fds/tree/">
        树
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fds/heap/">
        堆
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fds/union_find/">
        并查集
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fds/graph/">
        图
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fds/sort/">
        排序
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fds/hash/">
        哈希
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" id="__nav_2_3" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../">ads</a>
<label for="__nav_2_3">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="ads" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_3">
<span class="md-nav__icon md-icon"></span>
          ads
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          AVL 树, Splay 树, 摊还分析
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        AVL 树, Splay 树, 摊还分析
      </a>
<nav aria-label="目录" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      目录
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#avl">
    AVL 树
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#splay">
    Splay 树
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_1">
    摊还分析
  </a>
<nav aria-label="摊还分析" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_2">
    聚合法
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_3">
    核算法
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_4">
    势能法
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#splay_1">
    综合应用：Splay 树操作的摊还复杂度分析
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Lec2/">
        红黑树, b+ 树
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Lec4/">
        左式堆, 斜堆
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Lec8/">
        动态规划
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Lec9/">
        贪心算法
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Lec10/">
        $\mathsf{NP}$ 完全性
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Lec11/">
        近似算法
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Lec12/">
        局部搜索
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" id="__nav_3" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../math/">Math</a>
<label for="__nav_3">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="Math" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          Math
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" id="__nav_3_2" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../math/AbstractAlgebra/">AbstractAlgebra</a>
<label for="__nav_3_2">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="AbstractAlgebra" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_2">
<span class="md-nav__icon md-icon"></span>
          AbstractAlgebra
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/AbstractAlgebra/introduction/">
        Introduction
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2_3" id="__nav_3_2_3" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../math/AbstractAlgebra/ChapterI/">ChapterI</a>
<label for="__nav_3_2_3">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="ChapterI" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_2_3">
<span class="md-nav__icon md-icon"></span>
          ChapterI
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/AbstractAlgebra/ChapterI/Lec1/">
        1.1 群定义 循环群
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/AbstractAlgebra/ChapterI/Lec2/">
        1.2 同态与同构 陪集 正规子群与商群
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/AbstractAlgebra/ChapterI/Lec3/">
        1.3 对称群 交错群 二面体群
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/AbstractAlgebra/ChapterI/Lec4/">
        1.4 阿贝尔群
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/AbstractAlgebra/ChapterI/Lec5/">
        1.5 群作用
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/AbstractAlgebra/ChapterI/Lec6/">
        1.6 Sylow 定理 有限群分类
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/AbstractAlgebra/ChapterI/Lec7/">
        1.7 幂零群和可解群 正规列和次正规列
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2_4" id="__nav_3_2_4" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../math/AbstractAlgebra/ChapterII/">ChapterII</a>
<label for="__nav_3_2_4">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="ChapterII" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_2_4">
<span class="md-nav__icon md-icon"></span>
          ChapterII
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/AbstractAlgebra/ChapterII/Lec1/">
        2.1 环基本定义
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/AbstractAlgebra/ChapterII/Lec2/">
        2.2 理想
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/AbstractAlgebra/ChapterII/Lec3/">
        2.3 交换环上的因子分解
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/AbstractAlgebra/ChapterII/Lec4/">
        2.4 分式环 局部化
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/AbstractAlgebra/ChapterII/Lec5/">
        2.5 多项式环 形式幂级数
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/AbstractAlgebra/ChapterII/Lec6/">
        2.6 多项式环上的分解
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2_5" id="__nav_3_2_5" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../math/AbstractAlgebra/ChapterIII/">ChapterIII</a>
<label for="__nav_3_2_5">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="ChapterIII" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_2_5">
<span class="md-nav__icon md-icon"></span>
          ChapterIII
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/AbstractAlgebra/ChapterIII/Lec1/">
        3.1 模 模同态 正合列
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/AbstractAlgebra/ChapterIII/Lec2/">
        3.2 自由模和向量空间
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/AbstractAlgebra/ChapterIII/Lec3/">
        3.3 投射摸和内射模
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/AbstractAlgebra/ChapterIII/Lec4/">
        3.4 Hom 和 Tensor
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/AbstractAlgebra/ChapterIII/Lec5/">
        3.5 主理想整环上的有限生成模
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2_6" id="__nav_3_2_6" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../math/AbstractAlgebra/ChapterIV/">ChapterIV</a>
<label for="__nav_3_2_6">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="ChapterIV" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_2_6">
<span class="md-nav__icon md-icon"></span>
          ChapterIV
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/AbstractAlgebra/ChapterIV/Lec1/">
        4.1 域扩张
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/AbstractAlgebra/ChapterIV/Lec2/">
        4.2 Galois 理论基本定理
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/AbstractAlgebra/HW_archive/">
        Homework archive
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/AbstractAlgebra/Final/">
        Final Exam
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" id="__nav_3_3" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../math/NumberTheory/">NumberTheory</a>
<label for="__nav_3_3">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="NumberTheory" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_3">
<span class="md-nav__icon md-icon"></span>
          NumberTheory
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/NumberTheory/Lec1/">
        1 Euclidean Algorithm and Factorization
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/NumberTheory/Lec2/">
        2 Modular Arithmetic
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/NumberTheory/Lec3/">
        3 Some Diophantine Equations
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/NumberTheory/Lec4/">
        4 Order of units &amp; Application in cryptography
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/NumberTheory/Lec5/">
        5 Sum of Two Squares
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/NumberTheory/Lec6/">
        6 Quadratic Reciprocity Law
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/NumberTheory/Lec7/">
        7 Sum of Four Squares
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/NumberTheory/Lec8/">
        8 Quadratic Gauss Sum
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/NumberTheory/Lec9/">
        9 Pell's Equation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/NumberTheory/Lec10/">
        10 Factorization in Quadratic Fields
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/NumberTheory/Lec11/">
        11 Primes of Arithmetic Progression
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/NumberTheory/Lec12/">
        12 Sum of Three Squares
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/NumberTheory/Lec13/">
        13 Congruent Number
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/NumberTheory/HW_archive/">
        Homework archive
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/NumberTheory/Final/">
        Final Exam
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_4" id="__nav_3_4" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../math/AlgebraicNumberTheory/">AlgebraicNumberTheory</a>
<label for="__nav_3_4">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="AlgebraicNumberTheory" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_4">
<span class="md-nav__icon md-icon"></span>
          AlgebraicNumberTheory
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/AlgebraicNumberTheory/Lec1/">
        1 Integrality
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/AlgebraicNumberTheory/Lec2/">
        2 Norm, Trace, Discriminant
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../math/AlgebraicNumberTheory/Lec3/">
        3 Dedekind Domains
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_5" id="__nav_3_5" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../math/DGC/">DGC</a>
</div>
<nav aria-label="DGC" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_5">
<span class="md-nav__icon md-icon"></span>
          DGC
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" id="__nav_4" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../crypto/">Crypto</a>
<label for="__nav_4">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="Crypto" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
          Crypto
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../crypto/ECC/">
        ECC
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" id="__nav_4_3" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../crypto/Lattice/">Lattice</a>
<label for="__nav_4_3">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="Lattice" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_3">
<span class="md-nav__icon md-icon"></span>
          Lattice
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../crypto/Lattice/Lec1/">
        1 基本概念
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4" id="__nav_4_4" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../crypto/RSA/">RSA</a>
<label for="__nav_4_4">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="RSA" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_4">
<span class="md-nav__icon md-icon"></span>
          RSA
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../crypto/RSA/Lec1/">
        Factor $N$ given $N$, $e$, $d$
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="目录" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      目录
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#avl">
    AVL 树
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#splay">
    Splay 树
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_1">
    摊还分析
  </a>
<nav aria-label="摊还分析" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_2">
    聚合法
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_3">
    核算法
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_4">
    势能法
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#splay_1">
    综合应用：Splay 树操作的摊还复杂度分析
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1><span>AVL<span class="heti-spacing"> </span></span>树<span class="heti-skip"><span class="heti-spacing"> </span>, Splay<span class="heti-spacing"> </span></span>树<span class="heti-skip"><span class="heti-spacing"> </span>,<span class="heti-spacing"> </span></span>摊还分析</h1>
<h2 id="avl"><span>AVL<span class="heti-spacing"> </span></span>树<a class="headerlink" href="#avl" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h2>
<div class="admonition info">
<p class="admonition-title">Definition</p>
<p><strong>平衡树</strong>：空二叉树是平衡的<span class="heti-skip"><span class="heti-spacing"> </span>.<span class="heti-spacing"> </span></span>如果一棵二叉树的左子树和右子树的高度差的绝对值不超过<span><span class="heti-spacing"> </span>1</span>，且左右子树都是平衡的，那么这棵二叉树就是平衡的<span class="heti-skip"><span class="heti-spacing"> </span>.<span class="heti-spacing"> </span></span>空树的高度定义为<span><span class="heti-spacing"> </span>-1.</span></p>
<p><strong>平衡因子</strong>：<span><span class="arithmatex">\(BF(T) = h(T.left) - h(T.right)\)</span>.<span class="heti-spacing"> </span></span>所以在<span class="heti-skip"><span class="heti-spacing"> </span>AVL<span class="heti-spacing"> </span></span>树中，平衡因子的取值范围为<span><span class="heti-spacing"> </span><span class="arithmatex">\(-1, 0, 1\)</span>.</span></p>
</div>
<p><span>AVL<span class="heti-spacing"> </span></span>树的结点定义如下：</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">TreeNode</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">val</span><span class="p">;</span>
<a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="w">    </span><span class="n">TreeNode</span><span class="o">*</span><span class="w"> </span><span class="n">left</span><span class="p">;</span>
<a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="w">    </span><span class="n">TreeNode</span><span class="o">*</span><span class="w"> </span><span class="n">right</span><span class="p">;</span>
<a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">height</span><span class="p">;</span>
<a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="p">}</span><span class="w"> </span><span class="n">Node</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">AVLTree</span><span class="p">;</span>
</code></pre></div>
<p>失衡调整的措施是对树进行旋转操作，分为左旋和右旋。旋转的过程中需要对高度调整，使用到的宏有：</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="cp">#define HEIGHT(p) ((p) == NULL ? -1 : (((Node *)(p)))-&gt;height)</span>
<a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="cp">#define MAX(a, b) ((a) &gt; (b) ? (a) : (b))</span>
</code></pre></div>
<p>具体操作如下：</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio"/><input id="__tabbed_1_2" name="__tabbed_1" type="radio"/><div class="tabbed-labels"><label for="__tabbed_1_1">右旋</label><label for="__tabbed_1_2">左旋</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="n">Node</span><span class="w"> </span><span class="o">*</span><span class="nf">rightRotate</span><span class="p">(</span><span class="n">AVLTree</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="w">    </span><span class="n">AVLTreenew_p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
<a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="w">    </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_p</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="w">    </span><span class="n">new_p</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
<a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="w">    </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MAX</span><span class="p">(</span><span class="n">HEIGHT</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">),</span><span class="w"> </span><span class="n">HEIGHT</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<a href="#__codelineno-2-6" id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="w">    </span><span class="n">new_p</span><span class="o">-&gt;</span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MAX</span><span class="p">(</span><span class="n">HEIGHT</span><span class="p">(</span><span class="n">new_p</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">),</span><span class="w"> </span><span class="n">HEIGHT</span><span class="p">(</span><span class="n">new_p</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<a href="#__codelineno-2-7" id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">new_p</span><span class="p">;</span>
<a href="#__codelineno-2-8" id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="n">Node</span><span class="w"> </span><span class="o">*</span><span class="nf">leftRotate</span><span class="p">(</span><span class="n">AVLTree</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="w">    </span><span class="n">AVLTreenew_p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a href="#__codelineno-3-3" id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="w">    </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_p</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
<a href="#__codelineno-3-4" id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="w">    </span><span class="n">new_p</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
<a href="#__codelineno-3-5" id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="w">    </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MAX</span><span class="p">(</span><span class="n">HEIGHT</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">),</span><span class="w"> </span><span class="n">HEIGHT</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<a href="#__codelineno-3-6" id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="w">    </span><span class="n">new_p</span><span class="o">-&gt;</span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MAX</span><span class="p">(</span><span class="n">HEIGHT</span><span class="p">(</span><span class="n">new_p</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">),</span><span class="w"> </span><span class="n">HEIGHT</span><span class="p">(</span><span class="n">new_p</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<a href="#__codelineno-3-7" id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">new_p</span><span class="p">;</span>
<a href="#__codelineno-3-8" id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>根据造成失衡的插入位置，可以分为四种情况，其中<span class="heti-skip"><span class="heti-spacing"> </span>"LL"<span class="heti-spacing"> </span></span>和<span class="heti-skip"><span class="heti-spacing"> </span>"RR"<span class="heti-spacing"> </span></span>只需要一次旋转，而<span class="heti-skip"><span class="heti-spacing"> </span>"LR"<span class="heti-spacing"> </span></span>和<span class="heti-skip"><span class="heti-spacing"> </span>"RL"<span class="heti-spacing"> </span></span>需要两次旋转。</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:4"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio"/><input id="__tabbed_2_2" name="__tabbed_2" type="radio"/><input id="__tabbed_2_3" name="__tabbed_2" type="radio"/><input id="__tabbed_2_4" name="__tabbed_2" type="radio"/><div class="tabbed-labels"><label for="__tabbed_2_1">LL</label><label for="__tabbed_2_2">RR</label><label for="__tabbed_2_3">LR</label><label for="__tabbed_2_4">RL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="n">Node</span><span class="w"> </span><span class="o">*</span><span class="nf">LL_Rotate</span><span class="p">(</span><span class="n">AVLTree</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">rightRotate</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<a href="#__codelineno-4-3" id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="n">Node</span><span class="w"> </span><span class="o">*</span><span class="nf">RR_Rotate</span><span class="p">(</span><span class="n">AVLTree</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-5-2" id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">leftRotate</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<a href="#__codelineno-5-3" id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="n">Node</span><span class="w"> </span><span class="o">*</span><span class="nf">LR_Rotate</span><span class="p">(</span><span class="n">AVLTree</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-6-2" id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="w">    </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leftRotate</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">);</span>
<a href="#__codelineno-6-3" id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">rightRotate</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<a href="#__codelineno-6-4" id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="n">Node</span><span class="w"> </span><span class="o">*</span><span class="nf">RL_Rotate</span><span class="p">(</span><span class="n">AVLTree</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-7-2" id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="w">    </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rightRotate</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">);</span>
<a href="#__codelineno-7-3" id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">leftRotate</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<a href="#__codelineno-7-4" id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><span>AVL<span class="heti-spacing"> </span></span>树常见的操作如下：</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio"/><input id="__tabbed_3_2" name="__tabbed_3" type="radio"/><div class="tabbed-labels"><label for="__tabbed_3_1">创建节点</label><label for="__tabbed_3_2">插入节点</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="n">Node</span><span class="w"> </span><span class="o">*</span><span class="nf">CreateNode</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-8-2" id="__codelineno-8-2" name="__codelineno-8-2"></a><span class="w">    </span><span class="n">Node</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Node</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Node</span><span class="p">));</span>
<a href="#__codelineno-8-3" id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="w">    </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">val</span><span class="p">;</span>
<a href="#__codelineno-8-4" id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="w">    </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a href="#__codelineno-8-5" id="__codelineno-8-5" name="__codelineno-8-5"></a><span class="w">    </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a href="#__codelineno-8-6" id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
<a href="#__codelineno-8-7" id="__codelineno-8-7" name="__codelineno-8-7"></a><span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="n">Node</span><span class="w"> </span><span class="o">*</span><span class="nf">Insert</span><span class="p">(</span><span class="n">AVLTree</span><span class="w"> </span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-9-2" id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tree</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-9-3" id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="w">        </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CreateNode</span><span class="p">(</span><span class="n">val</span><span class="p">);</span>
<a href="#__codelineno-9-4" id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">val</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-9-5" id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="w">        </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Insert</span><span class="p">(</span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">,</span><span class="w"> </span><span class="n">val</span><span class="p">);</span>
<a href="#__codelineno-9-6" id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">HEIGHT</span><span class="p">(</span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">HEIGHT</span><span class="p">(</span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// 因为只插入一个节点，所以失衡必然为 2</span>
<a href="#__codelineno-9-7" id="__codelineno-9-7" name="__codelineno-9-7"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">val</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">left</span><span class="o">-&gt;</span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-9-8" id="__codelineno-9-8" name="__codelineno-9-8"></a><span class="w">                </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LL_Rotate</span><span class="p">(</span><span class="n">tree</span><span class="p">);</span>
<a href="#__codelineno-9-9" id="__codelineno-9-9" name="__codelineno-9-9"></a><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-9-10" id="__codelineno-9-10" name="__codelineno-9-10"></a><span class="w">                </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LR_Rotate</span><span class="p">(</span><span class="n">tree</span><span class="p">);</span>
<a href="#__codelineno-9-11" id="__codelineno-9-11" name="__codelineno-9-11"></a><span class="w">            </span><span class="p">}</span>
<a href="#__codelineno-9-12" id="__codelineno-9-12" name="__codelineno-9-12"></a><span class="w">        </span><span class="p">}</span>
<a href="#__codelineno-9-13" id="__codelineno-9-13" name="__codelineno-9-13"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">val</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-9-14" id="__codelineno-9-14" name="__codelineno-9-14"></a><span class="w">        </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Insert</span><span class="p">(</span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">,</span><span class="w"> </span><span class="n">val</span><span class="p">);</span>
<a href="#__codelineno-9-15" id="__codelineno-9-15" name="__codelineno-9-15"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">HEIGHT</span><span class="p">(</span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">HEIGHT</span><span class="p">(</span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// 因为只插入一个节点，所以失衡必然为 2</span>
<a href="#__codelineno-9-16" id="__codelineno-9-16" name="__codelineno-9-16"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">val</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">right</span><span class="o">-&gt;</span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-9-17" id="__codelineno-9-17" name="__codelineno-9-17"></a><span class="w">                </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RR_Rotate</span><span class="p">(</span><span class="n">tree</span><span class="p">);</span>
<a href="#__codelineno-9-18" id="__codelineno-9-18" name="__codelineno-9-18"></a><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-9-19" id="__codelineno-9-19" name="__codelineno-9-19"></a><span class="w">                </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RL_Rotate</span><span class="p">(</span><span class="n">tree</span><span class="p">);</span>
<a href="#__codelineno-9-20" id="__codelineno-9-20" name="__codelineno-9-20"></a><span class="w">            </span><span class="p">}</span>
<a href="#__codelineno-9-21" id="__codelineno-9-21" name="__codelineno-9-21"></a><span class="w">        </span><span class="p">}</span>
<a href="#__codelineno-9-22" id="__codelineno-9-22" name="__codelineno-9-22"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-9-23" id="__codelineno-9-23" name="__codelineno-9-23"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span><span class="c1">// 重复的节点</span>
<a href="#__codelineno-9-24" id="__codelineno-9-24" name="__codelineno-9-24"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-9-25" id="__codelineno-9-25" name="__codelineno-9-25"></a><span class="w">    </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MAX</span><span class="p">(</span><span class="n">HEIGHT</span><span class="p">(</span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">),</span><span class="w"> </span><span class="n">HEIGHT</span><span class="p">(</span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<a href="#__codelineno-9-26" id="__codelineno-9-26" name="__codelineno-9-26"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">tree</span><span class="p">;</span>
<a href="#__codelineno-9-27" id="__codelineno-9-27" name="__codelineno-9-27"></a><span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>使用<span class="heti-skip"><span class="heti-spacing"> </span>AVL<span class="heti-spacing"> </span></span>树进行查询的时间复杂度为<span><span class="heti-spacing"> </span><span class="arithmatex">\(O(h)\)</span></span>，其中<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(h\)</span><span class="heti-spacing"> </span></span>为树的高度。而高度为<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(h\)</span><span class="heti-spacing"> </span></span>的<span class="heti-skip"><span class="heti-spacing"> </span>AVL<span class="heti-spacing"> </span></span>树的最少节点数目记为<span><span class="heti-spacing"> </span><span class="arithmatex">\(n_h\)</span></span>，则<span><span class="heti-spacing"> </span><span class="arithmatex">\(n_h = n_{h-1} + n_{h-2} + 1\)</span></span>，运用斐波那契数列，可以得到<span><span class="heti-spacing"> </span><span class="arithmatex">\(n_h = F_{h+2} - 1\)</span>.</span> </p>
<h2 id="splay"><span>Splay<span class="heti-spacing"> </span></span>树<a class="headerlink" href="#splay" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h2>
<p>节点定义如下：</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">TreeNode</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-10-2" id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">val</span><span class="p">;</span>
<a href="#__codelineno-10-3" id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="w">    </span><span class="n">TreeNode</span><span class="o">*</span><span class="w"> </span><span class="n">left</span><span class="p">;</span>
<a href="#__codelineno-10-4" id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="w">    </span><span class="n">TreeNode</span><span class="o">*</span><span class="w"> </span><span class="n">right</span><span class="p">;</span>
<a href="#__codelineno-10-5" id="__codelineno-10-5" name="__codelineno-10-5"></a><span class="w">    </span><span class="n">TreeNode</span><span class="o">*</span><span class="w"> </span><span class="n">parent</span><span class="p">;</span>
<a href="#__codelineno-10-6" id="__codelineno-10-6" name="__codelineno-10-6"></a><span class="p">}</span><span class="w"> </span><span class="n">Node</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">SplayTree</span><span class="p">;</span>
</code></pre></div>
<p><span>Splay<span class="heti-spacing"> </span></span>树的基本操作也是通过旋转来实现的，左旋和右旋的操作如下：</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio"/><input id="__tabbed_4_2" name="__tabbed_4" type="radio"/><div class="tabbed-labels"><label for="__tabbed_4_1">左旋</label><label for="__tabbed_4_2">右旋</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">leftRotate</span><span class="p">(</span><span class="n">SplayTree</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-11-2" id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="w">    </span><span class="n">SplayTree</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a href="#__codelineno-11-3" id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="w">    </span><span class="c1">// 将 x 的左儿子设为 p 的右儿子，更新 x 的父节点</span>
<a href="#__codelineno-11-4" id="__codelineno-11-4" name="__codelineno-11-4"></a><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-11-5" id="__codelineno-11-5" name="__codelineno-11-5"></a><span class="w">        </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
<a href="#__codelineno-11-6" id="__codelineno-11-6" name="__codelineno-11-6"></a><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;</span><span class="n">left</span><span class="o">-&gt;</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
<a href="#__codelineno-11-7" id="__codelineno-11-7" name="__codelineno-11-7"></a><span class="w">        </span><span class="n">x</span><span class="o">-&gt;</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">;</span>
<a href="#__codelineno-11-8" id="__codelineno-11-8" name="__codelineno-11-8"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-11-9" id="__codelineno-11-9" name="__codelineno-11-9"></a>
<a href="#__codelineno-11-10" id="__codelineno-11-10" name="__codelineno-11-10"></a><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-11-11" id="__codelineno-11-11" name="__codelineno-11-11"></a><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-11-12" id="__codelineno-11-12" name="__codelineno-11-12"></a><span class="w">            </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<a href="#__codelineno-11-13" id="__codelineno-11-13" name="__codelineno-11-13"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-11-14" id="__codelineno-11-14" name="__codelineno-11-14"></a><span class="w">            </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<a href="#__codelineno-11-15" id="__codelineno-11-15" name="__codelineno-11-15"></a><span class="w">        </span><span class="p">}</span>
<a href="#__codelineno-11-16" id="__codelineno-11-16" name="__codelineno-11-16"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span>
<a href="#__codelineno-11-17" id="__codelineno-11-17" name="__codelineno-11-17"></a><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
<a href="#__codelineno-11-18" id="__codelineno-11-18" name="__codelineno-11-18"></a><span class="w">    </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<a href="#__codelineno-11-19" id="__codelineno-11-19" name="__codelineno-11-19"></a><span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-12-1" id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">rightRotate</span><span class="p">(</span><span class="n">SplayTree</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-12-2" id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="w">    </span><span class="n">SplayTree</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
<a href="#__codelineno-12-3" id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="w">    </span><span class="c1">// 将 x 的右儿子设为 p 的左儿子，更新 x 的父节点</span>
<a href="#__codelineno-12-4" id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-12-5" id="__codelineno-12-5" name="__codelineno-12-5"></a><span class="w">        </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a href="#__codelineno-12-6" id="__codelineno-12-6" name="__codelineno-12-6"></a><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;</span><span class="n">right</span><span class="o">-&gt;</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
<a href="#__codelineno-12-7" id="__codelineno-12-7" name="__codelineno-12-7"></a><span class="w">        </span><span class="n">x</span><span class="o">-&gt;</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">;</span>
<a href="#__codelineno-12-8" id="__codelineno-12-8" name="__codelineno-12-8"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-12-9" id="__codelineno-12-9" name="__codelineno-12-9"></a><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-12-10" id="__codelineno-12-10" name="__codelineno-12-10"></a><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-12-11" id="__codelineno-12-11" name="__codelineno-12-11"></a><span class="w">            </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<a href="#__codelineno-12-12" id="__codelineno-12-12" name="__codelineno-12-12"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-12-13" id="__codelineno-12-13" name="__codelineno-12-13"></a><span class="w">            </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<a href="#__codelineno-12-14" id="__codelineno-12-14" name="__codelineno-12-14"></a><span class="w">        </span><span class="p">}</span>
<a href="#__codelineno-12-15" id="__codelineno-12-15" name="__codelineno-12-15"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-12-16" id="__codelineno-12-16" name="__codelineno-12-16"></a><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
<a href="#__codelineno-12-17" id="__codelineno-12-17" name="__codelineno-12-17"></a><span class="w">    </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<a href="#__codelineno-12-18" id="__codelineno-12-18" name="__codelineno-12-18"></a><span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>而<span class="heti-skip"><span class="heti-spacing"> </span>Splay<span class="heti-spacing"> </span></span>树有三种调整的情况：  </p>
<ul>
<li><strong>Zig</strong><span>:<span class="heti-spacing"> </span></span>如果<span class="heti-skip"><span class="heti-spacing"> </span>x<span class="heti-spacing"> </span></span>是根节点，那么只需要一次旋转即可  </li>
<li><strong>Zig-Zig</strong><span>: child, parent, grandparent<span class="heti-spacing"> </span></span>三个节点在同一条链上  </li>
<li><strong>Zig-Zag</strong><span>: child, parent, grandparent<span class="heti-spacing"> </span></span>三个节点在不同的链上  </li>
</ul>
<p>所以<span class="heti-skip"><span class="heti-spacing"> </span>splay<span class="heti-spacing"> </span></span>操作的代码如下：</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-13-1" id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">splay</span><span class="p">(</span><span class="n">SplayTree</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-13-2" id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="w">    </span><span class="k">while</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-13-3" id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-13-4" id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="n">rightRotate</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">);</span>
<a href="#__codelineno-13-5" id="__codelineno-13-5" name="__codelineno-13-5"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="n">leftRotate</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">);</span>
<a href="#__codelineno-13-6" id="__codelineno-13-6" name="__codelineno-13-6"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-13-7" id="__codelineno-13-7" name="__codelineno-13-7"></a><span class="w">            </span><span class="n">rightRotate</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">);</span>
<a href="#__codelineno-13-8" id="__codelineno-13-8" name="__codelineno-13-8"></a><span class="w">            </span><span class="n">rightRotate</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">);</span>
<a href="#__codelineno-13-9" id="__codelineno-13-9" name="__codelineno-13-9"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-13-10" id="__codelineno-13-10" name="__codelineno-13-10"></a><span class="w">            </span><span class="n">leftRotate</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">);</span>
<a href="#__codelineno-13-11" id="__codelineno-13-11" name="__codelineno-13-11"></a><span class="w">            </span><span class="n">leftRotate</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">);</span>
<a href="#__codelineno-13-12" id="__codelineno-13-12" name="__codelineno-13-12"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-13-13" id="__codelineno-13-13" name="__codelineno-13-13"></a><span class="w">            </span><span class="n">rightRotate</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">);</span>
<a href="#__codelineno-13-14" id="__codelineno-13-14" name="__codelineno-13-14"></a><span class="w">            </span><span class="n">leftRotate</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">);</span>
<a href="#__codelineno-13-15" id="__codelineno-13-15" name="__codelineno-13-15"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-13-16" id="__codelineno-13-16" name="__codelineno-13-16"></a><span class="w">            </span><span class="n">leftRotate</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">);</span>
<a href="#__codelineno-13-17" id="__codelineno-13-17" name="__codelineno-13-17"></a><span class="w">            </span><span class="n">rightRotate</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">);</span>
<a href="#__codelineno-13-18" id="__codelineno-13-18" name="__codelineno-13-18"></a><span class="w">        </span><span class="p">}</span>
<a href="#__codelineno-13-19" id="__codelineno-13-19" name="__codelineno-13-19"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-13-20" id="__codelineno-13-20" name="__codelineno-13-20"></a><span class="p">}</span>
</code></pre></div>
<p><span>Splay<span class="heti-spacing"> </span></span>树的基本操作如下：</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:4"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio"/><input id="__tabbed_5_2" name="__tabbed_5" type="radio"/><input id="__tabbed_5_3" name="__tabbed_5" type="radio"/><input id="__tabbed_5_4" name="__tabbed_5" type="radio"/><div class="tabbed-labels"><label for="__tabbed_5_1">创建节点</label><label for="__tabbed_5_2">插入节点</label><label for="__tabbed_5_3">查找节点</label><label for="__tabbed_5_4">删除节点</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-14-1" id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="n">SplayTree</span><span class="w"> </span><span class="nf">CreateNode</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-14-2" id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="w">    </span><span class="n">SplayTree</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Node</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Node</span><span class="p">));</span>
<a href="#__codelineno-14-3" id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="w">    </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">val</span><span class="p">;</span>
<a href="#__codelineno-14-4" id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="w">    </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a href="#__codelineno-14-5" id="__codelineno-14-5" name="__codelineno-14-5"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
<a href="#__codelineno-14-6" id="__codelineno-14-6" name="__codelineno-14-6"></a><span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-15-1" id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="n">SplayTree</span><span class="w"> </span><span class="nf">Insert</span><span class="p">(</span><span class="n">SplayTree</span><span class="w"> </span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-15-2" id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tree</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-15-3" id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="w">        </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CreateNode</span><span class="p">(</span><span class="n">val</span><span class="p">);</span>
<a href="#__codelineno-15-4" id="__codelineno-15-4" name="__codelineno-15-4"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-15-5" id="__codelineno-15-5" name="__codelineno-15-5"></a><span class="w">        </span><span class="n">SplayTree</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="p">;</span>
<a href="#__codelineno-15-6" id="__codelineno-15-6" name="__codelineno-15-6"></a><span class="w">        </span><span class="n">SplayTree</span><span class="w"> </span><span class="n">pre</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a href="#__codelineno-15-7" id="__codelineno-15-7" name="__codelineno-15-7"></a><span class="w">        </span><span class="k">while</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-15-8" id="__codelineno-15-8" name="__codelineno-15-8"></a><span class="w">            </span><span class="n">pre</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
<a href="#__codelineno-15-9" id="__codelineno-15-9" name="__codelineno-15-9"></a><span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">val</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-15-10" id="__codelineno-15-10" name="__codelineno-15-10"></a><span class="w">                </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
<a href="#__codelineno-15-11" id="__codelineno-15-11" name="__codelineno-15-11"></a><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">val</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-15-12" id="__codelineno-15-12" name="__codelineno-15-12"></a><span class="w">                </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a href="#__codelineno-15-13" id="__codelineno-15-13" name="__codelineno-15-13"></a><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-15-14" id="__codelineno-15-14" name="__codelineno-15-14"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span><span class="c1">// 重复的节点</span>
<a href="#__codelineno-15-15" id="__codelineno-15-15" name="__codelineno-15-15"></a><span class="w">            </span><span class="p">}</span>
<a href="#__codelineno-15-16" id="__codelineno-15-16" name="__codelineno-15-16"></a><span class="w">        </span><span class="p">}</span>
<a href="#__codelineno-15-17" id="__codelineno-15-17" name="__codelineno-15-17"></a>
<a href="#__codelineno-15-18" id="__codelineno-15-18" name="__codelineno-15-18"></a><span class="w">        </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CreateNode</span><span class="p">(</span><span class="n">val</span><span class="p">);</span>
<a href="#__codelineno-15-19" id="__codelineno-15-19" name="__codelineno-15-19"></a><span class="w">        </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pre</span><span class="p">;</span>
<a href="#__codelineno-15-20" id="__codelineno-15-20" name="__codelineno-15-20"></a><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">val</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">pre</span><span class="o">-&gt;</span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-15-21" id="__codelineno-15-21" name="__codelineno-15-21"></a><span class="w">            </span><span class="n">pre</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
<a href="#__codelineno-15-22" id="__codelineno-15-22" name="__codelineno-15-22"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-15-23" id="__codelineno-15-23" name="__codelineno-15-23"></a><span class="w">            </span><span class="n">pre</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
<a href="#__codelineno-15-24" id="__codelineno-15-24" name="__codelineno-15-24"></a><span class="w">        </span><span class="p">}</span>
<a href="#__codelineno-15-25" id="__codelineno-15-25" name="__codelineno-15-25"></a><span class="w">        </span><span class="n">splay</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<a href="#__codelineno-15-26" id="__codelineno-15-26" name="__codelineno-15-26"></a><span class="w">        </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
<a href="#__codelineno-15-27" id="__codelineno-15-27" name="__codelineno-15-27"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-15-28" id="__codelineno-15-28" name="__codelineno-15-28"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">tree</span><span class="p">;</span>
<a href="#__codelineno-15-29" id="__codelineno-15-29" name="__codelineno-15-29"></a><span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-16-1" id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="n">SplayTree</span><span class="w"> </span><span class="nf">Search</span><span class="p">(</span><span class="n">SplayTree</span><span class="w"> </span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-16-2" id="__codelineno-16-2" name="__codelineno-16-2"></a><span class="w">    </span><span class="n">SplayTree</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="p">;</span>
<a href="#__codelineno-16-3" id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="w">    </span><span class="k">while</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-16-4" id="__codelineno-16-4" name="__codelineno-16-4"></a><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">val</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-16-5" id="__codelineno-16-5" name="__codelineno-16-5"></a><span class="w">            </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
<a href="#__codelineno-16-6" id="__codelineno-16-6" name="__codelineno-16-6"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">val</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-16-7" id="__codelineno-16-7" name="__codelineno-16-7"></a><span class="w">            </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a href="#__codelineno-16-8" id="__codelineno-16-8" name="__codelineno-16-8"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-16-9" id="__codelineno-16-9" name="__codelineno-16-9"></a><span class="w">            </span><span class="n">splay</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<a href="#__codelineno-16-10" id="__codelineno-16-10" name="__codelineno-16-10"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
<a href="#__codelineno-16-11" id="__codelineno-16-11" name="__codelineno-16-11"></a><span class="w">        </span><span class="p">}</span>
<a href="#__codelineno-16-12" id="__codelineno-16-12" name="__codelineno-16-12"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-16-13" id="__codelineno-16-13" name="__codelineno-16-13"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a href="#__codelineno-16-14" id="__codelineno-16-14" name="__codelineno-16-14"></a><span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-17-1" id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="n">SplayTree</span><span class="w"> </span><span class="nf">Delete</span><span class="p">(</span><span class="n">SplayTree</span><span class="w"> </span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-17-2" id="__codelineno-17-2" name="__codelineno-17-2"></a><span class="w">    </span><span class="n">SplayTree</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Search</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">val</span><span class="p">);</span>
<a href="#__codelineno-17-3" id="__codelineno-17-3" name="__codelineno-17-3"></a><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">tree</span><span class="p">;</span>
<a href="#__codelineno-17-4" id="__codelineno-17-4" name="__codelineno-17-4"></a><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-17-5" id="__codelineno-17-5" name="__codelineno-17-5"></a><span class="w">        </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a href="#__codelineno-17-6" id="__codelineno-17-6" name="__codelineno-17-6"></a><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span><span class="w"> </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a href="#__codelineno-17-7" id="__codelineno-17-7" name="__codelineno-17-7"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-17-8" id="__codelineno-17-8" name="__codelineno-17-8"></a><span class="w">        </span><span class="n">SplayTree</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
<a href="#__codelineno-17-9" id="__codelineno-17-9" name="__codelineno-17-9"></a><span class="w">        </span><span class="c1">// Find the maximum node in the left subtree</span>
<a href="#__codelineno-17-10" id="__codelineno-17-10" name="__codelineno-17-10"></a><span class="w">        </span><span class="k">while</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a href="#__codelineno-17-11" id="__codelineno-17-11" name="__codelineno-17-11"></a><span class="w">        </span><span class="n">splay</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<a href="#__codelineno-17-12" id="__codelineno-17-12" name="__codelineno-17-12"></a><span class="w">        </span><span class="n">x</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a href="#__codelineno-17-13" id="__codelineno-17-13" name="__codelineno-17-13"></a><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">)</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">right</span><span class="o">-&gt;</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<a href="#__codelineno-17-14" id="__codelineno-17-14" name="__codelineno-17-14"></a><span class="w">        </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<a href="#__codelineno-17-15" id="__codelineno-17-15" name="__codelineno-17-15"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-17-16" id="__codelineno-17-16" name="__codelineno-17-16"></a><span class="w">    </span><span class="n">free</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<a href="#__codelineno-17-17" id="__codelineno-17-17" name="__codelineno-17-17"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">tree</span><span class="p">;</span>
<a href="#__codelineno-17-18" id="__codelineno-17-18" name="__codelineno-17-18"></a><span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="_1">摊还分析<a class="headerlink" href="#_1" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h2>
<p>摊还分析是一种分析数据结构和算法的平块平均性能的方法。其一般要从空结构开始，如果不从空结构开始，则必须要求连续的操作数量足够大，从而抵消初始步骤中可能出现的消耗较大的操作。</p>
<p>以下方法的分析示例基于<span><span class="heti-spacing"> </span>Multi-Stack</span>，其包括了三种操作：<code>push</code>, <code>pop</code>, <code>multipop</code>。<code>push</code> 和 <code>pop</code> 与平常无异， <code>multipop</code> 操作是将栈中的<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(n = \operatorname{min}(k, \operatorname{Sizeof}(stack))\)</span><span class="heti-spacing"> </span></span>个元素弹出，其中<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(k\)</span><span class="heti-spacing"> </span></span>为传入的参数。所以 <code>push</code> 和 <code>pop</code> 一次的代价为<span><span class="heti-spacing"> </span>1</span>，<code>multipop</code> 一次的代价为<span><span class="heti-spacing"> </span><span class="arithmatex">\(n\)</span></span>。</p>
<h3 id="_2">聚合法<a class="headerlink" href="#_2" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h3>
<p>聚合法的想法是找出连续<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(n\)</span><span class="heti-spacing"> </span></span>个操作中的最坏序列情况，并且排除掉不可能出现的所谓“最坏情况”。若其耗时为<span><span class="heti-spacing"> </span><span class="arithmatex">\(T_n\)</span></span>，则摊还时间为<span><span class="heti-spacing"> </span><span class="arithmatex">\(T_n/n\)</span></span>。</p>
<details class="example">
<summary>Multi-Stack</summary>
<p>如果我们只是暴力分析最差情况，认为 <code>multipop</code> 的最差情况是每次都 <code>multipop</code> 出<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(n\)</span><span class="heti-spacing"> </span></span>个元素，那么其时间复杂度将会达到<span><span class="heti-spacing"> </span><span class="arithmatex">\(O(n^2)\)</span></span>，这显然是不合理的，因为栈中没有那么多元素<span class="heti-skip"><span class="heti-spacing"> </span>.<span class="heti-spacing"> </span></span>所以我们利用聚合法来分析其摊还时间复杂度，这里面的最坏情况是<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(n - 1\)</span><span class="heti-spacing"> </span></span>次 <code>push</code> 和一次<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(n - 1\)</span><span class="heti-spacing"> </span></span>个元素的 <code>multipop</code>，所以总开销为<span><span class="heti-spacing"> </span><span class="arithmatex">\(T_n = 2n - 2\)</span></span>，摊还时间复杂度为<span><span class="heti-spacing"> </span><span class="arithmatex">\(T_n/n = O(n)/n = O(1)\)</span>.</span></p>
</details>
<h3 id="_3">核算法<a class="headerlink" href="#_3" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h3>
<p>核算法的想法是截长补短，让所有操作能够保持在同一复杂度层级上，便于分析。设第<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(i\)</span><span class="heti-spacing"> </span></span>种操作的真实成本为<span><span class="heti-spacing"> </span><span class="arithmatex">\(c_i\)</span></span>，截长补短的摊还成本为 </p>
<div class="arithmatex">\[ 
    \hat{c_i} = c_i + \Delta_i.
\]</div>
<p>其中的<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(\Delta_i\)</span><span class="heti-spacing"> </span></span>就表示了第<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(i\)</span><span class="heti-spacing"> </span></span>种操作的“取长补短”。但我们还需要保证摊还成本要比平均成本来得大，这样才能确保摊还分析得到的时间复杂度是平均时间复杂度的上界，所以我们需要满足</p>
<div class="arithmatex">\[
    \sum_{i=1}^n \hat{c_i} \geqslant \sum_{i=1}^n c_i, \ \forall n \in \mathbb{N}.
\]</div>
<p>也就是说<span><span class="heti-spacing"> </span><span class="arithmatex">\(\sum_{i=1}^n \Delta_i \geqslant 0\)</span>.</span></p>
<details class="tip">
<summary>Tip</summary>
<p>杨洋老师在课上打了一个很形象的比方。假设有一家卖汽水的小卖部，每瓶汽水<span class="heti-skip"><span class="heti-spacing"> </span>1<span class="heti-spacing"> </span></span>块钱，但你可以多花钱去买<span class="heti-skip"><span class="heti-spacing"> </span>1<span class="heti-spacing"> </span></span>瓶汽水，比如用<span class="heti-skip"><span class="heti-spacing"> </span>10<span class="heti-spacing"> </span></span>块钱，那么剩下的<span class="heti-skip"><span class="heti-spacing"> </span>9<span class="heti-spacing"> </span></span>块钱就是你的“积分”，在之后的某一天你便可以使用“积分”来买汽水而不另外付钱。同时，也要保证不赊账，也就是说你的“积分”不能为负。</p>
</details>
<details class="example">
<summary>Multi-Stack</summary>
<p>基于核算法的思想，我们可以将每次<span class="heti-skip"><span class="heti-spacing"> </span>push<span class="heti-spacing"> </span></span>的代价设为<span><span class="heti-spacing"> </span>2</span>，也就是说，我们预先将这个元素出栈的代价在入栈时就算在内，尽管它有可能不会出栈<span class="heti-skip"><span class="heti-spacing"> </span>.<span class="heti-spacing"> </span></span>这样，每次 <code>pop</code> 和 <code>multipop</code> 的代价就是<span class="heti-skip"><span class="heti-spacing"> </span>0<span class="heti-spacing"> </span></span>了<span class="heti-skip"><span class="heti-spacing"> </span>.<span class="heti-spacing"> </span></span>而因为<span><span class="heti-spacing"> </span><span class="arithmatex">\(\operatorname{Sizeof}(stack) \geqslant 0\)</span></span>，所以我们可以保证<span><span class="heti-spacing"> </span><span class="arithmatex">\(\sum_{i=1}^n \Delta_i \geqslant 0\)</span></span>。所以每种操作的代价都是<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(O(1)\)</span><span class="heti-spacing"> </span></span>级别的，最终的摊还复杂度为<span><span class="heti-spacing"> </span><span class="arithmatex">\(O(n)/n = O(1)\)</span>.</span></p>
</details>
<h3 id="_4">势能法<a class="headerlink" href="#_4" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h3>
<p>核算法的“截长补短”想法是很好的，但通常并不那么容易实现，因为设计出一个摊还代价<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(\hat{c_i}\)</span><span class="heti-spacing"> </span></span>并且保证<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(\sum_{i=1}^n \Delta_i \geqslant 0\)</span><span class="heti-spacing"> </span></span>是相对困难的。因此我们希望在整个结构上能有某种度量，而非只局限在每个操作上，势能法就应运而生了。我们为整个结构定义一个势函数，其与这个结构中的某些特征量相关，便能够比较好的衡量每次操作对整个结构的影响以及相应的代价。定义第<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(i\)</span><span class="heti-spacing"> </span></span>次操作的摊还代价为</p>
<div class="arithmatex">\[
    \hat{c_i} = c_i + (\Phi(D_i) - \Phi(D_{i - 1})).  
\]</div>
<p>求和得到</p>
<div class="arithmatex">\[\begin{align}
    \sum_{i=1}^n \hat{c_i} &amp;= \sum_{i=1}^n (c_i + (\Phi(D_i) - \Phi(D_{i - 1}))) \\
    &amp;= \sum_{i=1}^n c_i + \Phi(D_n) - \Phi(D_0).
\end{align}\]</div>
<p>我们依然需要<span><span class="heti-spacing"> </span><span class="arithmatex">\(\sum_{i=1}^n \hat{c_i} \geqslant \sum_{i=1}^n c_i\)</span></span>，所以我们需要保证<span><span class="heti-spacing"> </span><span class="arithmatex">\(\Phi(D_n) - \Phi(D_0) \geqslant 0\)</span></span>，也就是说，我们需要保证势函数始终不比初始状态小，这点是容易做到的，因为我们可以将初始状态的势函数设为<span><span class="heti-spacing"> </span>0</span>。</p>
<details class="example">
<summary>Multi-Stack</summary>
<p>设<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(D_i\)</span><span class="heti-spacing"> </span></span>为第<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(i\)</span><span class="heti-spacing"> </span></span>次操作后的栈，势函数<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(\Phi(D_i)\)</span><span class="heti-spacing"> </span></span>定义为栈中元素的个数<span class="heti-skip"><span class="heti-spacing"> </span>.<span class="heti-spacing"> </span></span>显然栈中元素的个数不会小于<span><span class="heti-spacing"> </span><span class="arithmatex">\(0\)</span></span>，所以有<span><span class="heti-spacing"> </span><span class="arithmatex">\(\Phi(D_i) \geqslant \Phi(D_0)\)</span></span>。接下来计算每种操作的摊还代价：</p>
<ul>
<li><code>push</code>：<span class="arithmatex">\(\hat{c_i} = 1 + (\Phi(D_i) - \Phi(D_{i - 1})) = 1 + 1 = 2\)</span>；  </li>
<li><code>pop</code>：<span class="arithmatex">\(\hat{c_i} = 1 + (\Phi(D_i) - \Phi(D_{i - 1})) = 1 + (-1) = 0\)</span>；  </li>
<li><code>multipop</code>：<span class="arithmatex">\(\hat{c_i} = n + (\Phi(D_i) - \Phi(D_{i - 1})) = n + (-n) = 0\)</span>.</li>
</ul>
<p>从而<span><span class="heti-spacing"> </span><span class="arithmatex">\(\sum_{i = 1}^n \hat{c_i} = \sum_{i = 1}^n O(1) = O(n)\)</span></span>，最终的摊还复杂度为<span><span class="heti-spacing"> </span><span class="arithmatex">\(O(n)/n = O(1)\)</span>.</span></p>
</details>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Consider the following buffer management problem. Initially the buffer size (the number of blocks) is one. Each block can accommodate exactly one item. As soon as a new item arrives, check if there is an available block. If yes, put the item into the block, induced a cost of one. Otherwise, the buffer size is doubled, and then the item is able to put into. Moreover, the old items have to be moved into the new buffer so it costs <span class="arithmatex">\(k + 1\)</span> to make this insertion, where <span class="arithmatex">\(k\)</span> is the number of old items. Clearly, if there are <span class="arithmatex">\(N\)</span> items, the worst-case cost for one insertion can be <span class="arithmatex">\(\Omega(N)\)</span>. To show that the average cost is <span class="arithmatex">\(O(1)\)</span>, let us turn to the amortized analysis. To simplify the problem, assume that the buffer is full after all the <span class="arithmatex">\(N\)</span> items are placed. Which of the following potential functions works?</p>
<ol>
<li>The number of items currently in the buffer</li>
<li>The opposite number of items currently in the buffer</li>
<li>The number of available blocks currently in the buffer</li>
<li>The opposite number of available blocks in the buffer</li>
</ol>
<details class="note">
<summary>answer</summary>
<p>设<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(k_i\)</span><span class="heti-spacing"> </span></span>为第<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(i\)</span><span class="heti-spacing"> </span></span>次插入前<span class="heti-skip"><span class="heti-spacing"> </span>buffer<span class="heti-spacing"> </span></span>内的元素个数，<span><span class="arithmatex">\(s_i\)</span><span class="heti-spacing"> </span></span>为第<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(i\)</span><span class="heti-spacing"> </span></span>次插入前<span class="heti-skip"><span class="heti-spacing"> </span>buffer<span class="heti-spacing"> </span></span>的大小，<span><span class="arithmatex">\(c_i\)</span><span class="heti-spacing"> </span></span>为第<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(i\)</span><span class="heti-spacing"> </span></span>次插入的实际代价，<span><span class="arithmatex">\(\phi_i\)</span><span class="heti-spacing"> </span></span>为第<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(i\)</span><span class="heti-spacing"> </span></span>次插入的势能<span class="heti-skip"><span class="heti-spacing"> </span>.<span class="heti-spacing"> </span></span>则有：</p>
<div class="arithmatex">\[
    \hat{c_i} = c_i + \phi_i - \phi_{i-1}
\]</div>
<p>若插入前<span class="heti-skip"><span class="heti-spacing"> </span>buffer<span class="heti-spacing"> </span></span>没满，则<span><span class="heti-spacing"> </span><span class="arithmatex">\(c_i = 1\)</span></span>；若插入前<span class="heti-skip"><span class="heti-spacing"> </span>buffer<span class="heti-spacing"> </span></span>已满，则<span><span class="heti-spacing"> </span><span class="arithmatex">\(c_i = k_i + 1 = s_i + 1\)</span>.</span></p>
<ol>
<li><span>buffer<span class="heti-spacing"> </span></span>未满时，<span class="arithmatex">\(\hat{c_i} = 1 + k_i + 1 - k_i = 2\)</span>；<span>buffer<span class="heti-spacing"> </span></span>满时，<span><span class="arithmatex">\(\hat{c_i} = k_i + 1 + k_i + 1 - k_i = k_i + 2\)</span>.<span class="heti-spacing"> </span></span>这是<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(k_i\)</span><span class="heti-spacing"> </span></span>相关的，且我们无法估计<span class="heti-skip"><span class="heti-spacing"> </span>buffer<span class="heti-spacing"> </span></span>插满的次数，所以不合适<span><span class="heti-spacing"> </span>.</span></li>
<li><span>buffer<span class="heti-spacing"> </span></span>未满时，<span class="arithmatex">\(\hat{c_i} = 1 + (-k_i - 1) - (-k_i) = 0\)</span>；<span>buffer<span class="heti-spacing"> </span></span>满时，<span><span class="arithmatex">\(\hat{c_i} = k_i + 1 + (-k_i - 1) - (-k_i) = k_i\)</span>.<span class="heti-spacing"> </span></span>这是<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(k_i\)</span><span class="heti-spacing"> </span></span>相关的，且我们无法估计<span class="heti-skip"><span class="heti-spacing"> </span>buffer<span class="heti-spacing"> </span></span>插满的次数，所以不合适<span><span class="heti-spacing"> </span>.</span></li>
<li><span>buffer<span class="heti-spacing"> </span></span>未满时，<span class="arithmatex">\(\hat{c_i} = 1 + (s_i - k_i - 1) - (s_i - k_i) = 0\)</span>；<span>buffer<span class="heti-spacing"> </span></span>满时，<span><span class="arithmatex">\(\hat{c_i} = k_i + 1 + (2s_i - k_i - 1) - (s_i - k_i) = 2s_i\)</span>.<span class="heti-spacing"> </span></span>这是<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(s_i\)</span><span class="heti-spacing"> </span></span>相关的，且我们无法估计<span class="heti-skip"><span class="heti-spacing"> </span>buffer<span class="heti-spacing"> </span></span>插满的次数，所以不合适<span><span class="heti-spacing"> </span>.</span></li>
<li><span>buffer<span class="heti-spacing"> </span></span>未满时，<span class="arithmatex">\(\hat{c_i} = 1 + (-s_i + k_i + 1) - (-s_i + k_i) = 2\)</span>；<span>buffer<span class="heti-spacing"> </span></span>满时，<span><span class="arithmatex">\(\hat{c_i} = k_i + 1 + (-2s_i + k_i + 1) - (-s_i + k_i) = 2\)</span>.<span class="heti-spacing"> </span></span>这是一个常数，所以合适<span><span class="heti-spacing"> </span>.</span></li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>此处题目做出的简化是第<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(N\)</span><span class="heti-spacing"> </span></span>次一定插满，但更深层次的意义是中间过程的势函数均不予考虑，也就不考虑中间过程势函数小于初始状态的情况<span class="heti-skip"><span class="heti-spacing"> </span>.<span class="heti-spacing"> </span></span>不能算是很合理的简化，但只能顺应题目的意思做<span><span class="heti-spacing"> </span>.</span></p>
</div>
</details>
</div>
<h3 id="splay_1">综合应用：<span>Splay<span class="heti-spacing"> </span></span>树操作的摊还复杂度分析<a class="headerlink" href="#splay_1" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h3>
<p>我们期望<span class="heti-skip"><span class="heti-spacing"> </span>Splay<span class="heti-spacing"> </span></span>树每个操作的摊还复杂度都是<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(O(\log n)\)</span><span class="heti-spacing"> </span></span>级别的，而回忆 </p>
<div class="arithmatex">\[
    \sum_{i=1}^n \hat{c_i} = \sum_{i=1}^n c_i + \Phi(D_n) - \Phi(D_0).
\]</div>
<p>所以我们期望<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(\Phi(D_n)\)</span><span class="heti-spacing"> </span></span>是<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(O(n \log n)\)</span><span class="heti-spacing"> </span></span>级别的。并且<span class="heti-skip"><span class="heti-spacing"> </span>Splay<span class="heti-spacing"> </span></span>树的操作是以旋转为基础的，<span>Zig-Zig<span class="heti-spacing"> </span></span>和<span class="heti-skip"><span class="heti-spacing"> </span>Zig-Zag<span class="heti-spacing"> </span></span>操作都是旋转次数为<span><span class="heti-spacing"> </span>2</span>，但我们并不知道这二者进行了多少次，所以希望能够在势函数中将旋转造成的开销给清除掉，以避免常数项求和引入<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(O(n)\)</span><span class="heti-spacing"> </span></span>级别的复杂度。至于<span class="heti-skip"><span class="heti-spacing"> </span>Zig<span class="heti-spacing"> </span></span>操作，其最多可能出现<span class="heti-skip"><span class="heti-spacing"> </span>1<span class="heti-spacing"> </span></span>次，所以我们不考虑消除其旋转的开销。所以，定义<span><span class="heti-spacing"> </span><span class="arithmatex">\(\Phi(D_i) = \log S(D_i)\)</span></span>，即以<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(D_i\)</span><span class="heti-spacing"> </span></span>为根节点的最大子树的节点个数（秩<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>。</p>
<p>而为了计算摊还复杂度时的放缩方便，我们有以下一个引理</p>
<div class="admonition success">
<p class="admonition-title">引理</p>
<p>若<span><span class="heti-spacing"> </span><span class="arithmatex">\(a + b \leqslant c\)</span></span>，且<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(a, b\)</span><span class="heti-spacing"> </span></span>均为正整数，则</p>
<div class="arithmatex">\[
    \log a + \log b \leqslant 2 \log c - 2.
\]</div>
</div>
<p>接下来分析三种操作的开销：</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:3"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio"/><input id="__tabbed_6_2" name="__tabbed_6" type="radio"/><input id="__tabbed_6_3" name="__tabbed_6" type="radio"/><div class="tabbed-labels"><label for="__tabbed_6_1">Zig</label><label for="__tabbed_6_2">Zig-Zag</label><label for="__tabbed_6_3">Zig-Zag</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p></p><div style="text-align: center; zoom: 1.5;"><!-- This file was generated by dvisvgm 2.13.3 --><svg height="82.19726pt" version="1.1" viewbox="-72.000004 -72.000011 308.968807 82.19726" width="308.968807pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M3.01868-3.148194H4.712329C6.127024-3.148194 7.511831-4.184309 7.511831-5.300125C7.511831-6.067248 6.854296-6.804483 5.549191-6.804483H2.321295C2.132005-6.804483 2.022416-6.804483 2.022416-6.615193C2.022416-6.495641 2.11208-6.495641 2.311333-6.495641C2.440847-6.495641 2.620174-6.485679 2.739726-6.475716C2.899128-6.455791 2.958904-6.425903 2.958904-6.316314C2.958904-6.276463 2.948941-6.246575 2.919054-6.127024L1.58406-.777086C1.484433-.388543 1.464508-.308842 .67746-.308842C.508095-.308842 .398506-.308842 .398506-.119552C.398506 0 .518057 0 .547945 0C.826899 0 1.534247-.029888 1.8132-.029888C2.022416-.029888 2.241594-.019925 2.450809-.019925C2.669988-.019925 2.889166 0 3.098381 0C3.16812 0 3.297634 0 3.297634-.199253C3.297634-.308842 3.20797-.308842 3.01868-.308842C2.650062-.308842 2.371108-.308842 2.371108-.488169C2.371108-.547945 2.391034-.597758 2.400996-.657534L3.01868-3.148194ZM3.73599-6.117061C3.825654-6.465753 3.845579-6.495641 4.273973-6.495641H5.230386C6.057285-6.495641 6.585305-6.22665 6.585305-5.539228C6.585305-5.150685 6.386052-4.293898 5.997509-3.935243C5.499377-3.486924 4.901619-3.407223 4.463263-3.407223H3.058531L3.73599-6.117061Z" id="g1-80"></path><path d="M4.83188-4.094645L3.995019-6.07721C3.965131-6.156912 3.945205-6.196762 3.945205-6.206725C3.945205-6.266501 4.11457-6.455791 4.533001-6.495641C4.632628-6.505604 4.732254-6.515567 4.732254-6.684932C4.732254-6.804483 4.612702-6.804483 4.582814-6.804483C4.174346-6.804483 3.745953-6.774595 3.327522-6.774595C3.078456-6.774595 2.460772-6.804483 2.211706-6.804483C2.15193-6.804483 2.032379-6.804483 2.032379-6.60523C2.032379-6.495641 2.132005-6.495641 2.261519-6.495641C2.859278-6.495641 2.919054-6.396015 3.008717-6.176837L4.184309-3.39726L2.082192-1.135741L1.952677-1.026152C1.464508-.498132 .996264-.33873 .488169-.308842C.358655-.298879 .268991-.298879 .268991-.109589C.268991-.099626 .268991 0 .398506 0C.697385 0 1.026152-.029888 1.334994-.029888C1.703611-.029888 2.092154 0 2.450809 0C2.510585 0 2.630137 0 2.630137-.199253C2.630137-.298879 2.530511-.308842 2.510585-.308842C2.420922-.318804 2.11208-.33873 2.11208-.617684C2.11208-.777086 2.261519-.936488 2.381071-1.066002L3.39726-2.141968L4.293898-3.118306L5.300125-.737235C5.339975-.627646 5.349938-.617684 5.349938-.597758C5.349938-.518057 5.160648-.348692 4.772105-.308842C4.662516-.298879 4.572852-.288917 4.572852-.119552C4.572852 0 4.682441 0 4.722291 0C5.001245 0 5.69863-.029888 5.977584-.029888C6.22665-.029888 6.834371 0 7.083437 0C7.153176 0 7.272727 0 7.272727-.18929C7.272727-.308842 7.173101-.308842 7.0934-.308842C6.425903-.318804 6.405978-.348692 6.236613-.747198C5.84807-1.673724 5.180573-3.227895 4.951432-3.825654C5.628892-4.523039 6.674969-5.708593 6.993773-5.987547C7.28269-6.22665 7.66127-6.465753 8.259029-6.495641C8.388543-6.505604 8.478207-6.505604 8.478207-6.694894C8.478207-6.704857 8.478207-6.804483 8.348692-6.804483C8.049813-6.804483 7.721046-6.774595 7.412204-6.774595C7.043587-6.774595 6.665006-6.804483 6.306351-6.804483C6.246575-6.804483 6.117061-6.804483 6.117061-6.60523C6.117061-6.535492 6.166874-6.505604 6.236613-6.495641C6.326276-6.485679 6.635118-6.465753 6.635118-6.1868C6.635118-6.047323 6.525529-5.917808 6.445828-5.828144L4.83188-4.094645Z" id="g1-88"></path><path d="M3.327522-3.008717C3.387298-3.267746 3.616438-4.184309 4.313823-4.184309C4.363636-4.184309 4.60274-4.184309 4.811955-4.054795C4.533001-4.004981 4.333748-3.755915 4.333748-3.516812C4.333748-3.35741 4.443337-3.16812 4.712329-3.16812C4.931507-3.16812 5.250311-3.347447 5.250311-3.745953C5.250311-4.26401 4.662516-4.403487 4.323786-4.403487C3.745953-4.403487 3.39726-3.875467 3.277709-3.646326C3.028643-4.303861 2.49066-4.403487 2.201743-4.403487C1.165629-4.403487 .597758-3.118306 .597758-2.86924C.597758-2.769614 .697385-2.769614 .71731-2.769614C.797011-2.769614 .826899-2.789539 .846824-2.879203C1.185554-3.935243 1.843088-4.184309 2.181818-4.184309C2.371108-4.184309 2.719801-4.094645 2.719801-3.516812C2.719801-3.20797 2.550436-2.540473 2.181818-1.145704C2.022416-.52802 1.673724-.109589 1.235367-.109589C1.175592-.109589 .946451-.109589 .737235-.239103C.986301-.288917 1.205479-.498132 1.205479-.777086C1.205479-1.046077 .986301-1.125778 .836862-1.125778C.537983-1.125778 .288917-.86675 .288917-.547945C.288917-.089664 .787049 .109589 1.225405 .109589C1.882939 .109589 2.241594-.587796 2.271482-.647572C2.391034-.278954 2.749689 .109589 3.347447 .109589C4.373599 .109589 4.941469-1.175592 4.941469-1.424658C4.941469-1.524284 4.851806-1.524284 4.821918-1.524284C4.732254-1.524284 4.712329-1.484433 4.692403-1.414695C4.363636-.348692 3.686177-.109589 3.367372-.109589C2.978829-.109589 2.819427-.428394 2.819427-.767123C2.819427-.986301 2.879203-1.205479 2.988792-1.643836L3.327522-3.008717Z" id="g1-120"></path><path d="M4.841843-3.795766C4.881694-3.935243 4.881694-3.955168 4.881694-4.024907C4.881694-4.204234 4.742217-4.293898 4.592777-4.293898C4.493151-4.293898 4.333748-4.234122 4.244085-4.084682C4.224159-4.034869 4.144458-3.726027 4.104608-3.5467C4.034869-3.287671 3.965131-3.01868 3.905355-2.749689L3.457036-.956413C3.417186-.806974 2.988792-.109589 2.331258-.109589C1.823163-.109589 1.713574-.547945 1.713574-.916563C1.713574-1.374844 1.882939-1.992528 2.221669-2.86924C2.381071-3.277709 2.420922-3.387298 2.420922-3.58655C2.420922-4.034869 2.102117-4.403487 1.603985-4.403487C.657534-4.403487 .288917-2.958904 .288917-2.86924C.288917-2.769614 .388543-2.769614 .408468-2.769614C.508095-2.769614 .518057-2.789539 .56787-2.948941C.836862-3.88543 1.235367-4.184309 1.574097-4.184309C1.653798-4.184309 1.823163-4.184309 1.823163-3.865504C1.823163-3.616438 1.723537-3.35741 1.653798-3.16812C1.255293-2.11208 1.075965-1.544209 1.075965-1.075965C1.075965-.18929 1.703611 .109589 2.291407 .109589C2.67995 .109589 3.01868-.059776 3.297634-.33873C3.16812 .179328 3.048568 .667497 2.650062 1.195517C2.391034 1.534247 2.012453 1.823163 1.554172 1.823163C1.414695 1.823163 .966376 1.793275 .797011 1.404732C.956413 1.404732 1.085928 1.404732 1.225405 1.285181C1.325031 1.195517 1.424658 1.066002 1.424658 .876712C1.424658 .56787 1.155666 .52802 1.05604 .52802C.826899 .52802 .498132 .687422 .498132 1.175592C.498132 1.673724 .936488 2.042341 1.554172 2.042341C2.580324 2.042341 3.606476 1.135741 3.88543 .009963L4.841843-3.795766Z" id="g1-121"></path><path d="M1.325031-.826899C1.863014-1.404732 2.15193-1.653798 2.510585-1.96264C2.510585-1.972603 3.128269-2.500623 3.486924-2.859278C4.433375-3.785803 4.652553-4.26401 4.652553-4.303861C4.652553-4.403487 4.562889-4.403487 4.542964-4.403487C4.473225-4.403487 4.443337-4.383562 4.393524-4.293898C4.094645-3.815691 3.88543-3.656289 3.646326-3.656289S3.287671-3.805729 3.138232-3.975093C2.948941-4.204234 2.779577-4.403487 2.450809-4.403487C1.703611-4.403487 1.24533-3.476961 1.24533-3.267746C1.24533-3.217933 1.275218-3.158157 1.364882-3.158157S1.474471-3.20797 1.494396-3.267746C1.683686-3.726027 2.261519-3.73599 2.34122-3.73599C2.550436-3.73599 2.739726-3.666252 2.968867-3.58655C3.367372-3.437111 3.476961-3.437111 3.73599-3.437111C3.377335-3.008717 2.540473-2.291407 2.351183-2.132005L1.454545-1.295143C.777086-.627646 .428394-.059776 .428394 .009963C.428394 .109589 .52802 .109589 .547945 .109589C.627646 .109589 .647572 .089664 .707347-.019925C.936488-.368618 1.235367-.637609 1.554172-.637609C1.783313-.637609 1.882939-.547945 2.132005-.259029C2.30137-.049813 2.480697 .109589 2.769614 .109589C3.755915 .109589 4.333748-1.155666 4.333748-1.424658C4.333748-1.474471 4.293898-1.524284 4.214197-1.524284C4.124533-1.524284 4.104608-1.464508 4.07472-1.39477C3.845579-.747198 3.20797-.557908 2.879203-.557908C2.67995-.557908 2.500623-.617684 2.291407-.687422C1.952677-.816936 1.803238-.856787 1.594022-.856787C1.574097-.856787 1.414695-.856787 1.325031-.826899Z" id="g1-122"></path><path d="M4.811955-.886675V-1.444583H4.562889V-.886675C4.562889-.308842 4.313823-.249066 4.204234-.249066C3.875467-.249066 3.835616-.697385 3.835616-.747198V-2.739726C3.835616-3.158157 3.835616-3.5467 3.476961-3.915318C3.088418-4.303861 2.590286-4.463263 2.11208-4.463263C1.295143-4.463263 .607721-3.995019 .607721-3.337484C.607721-3.038605 .806974-2.86924 1.066002-2.86924C1.344956-2.86924 1.524284-3.068493 1.524284-3.327522C1.524284-3.447073 1.474471-3.775841 1.016189-3.785803C1.285181-4.134496 1.77335-4.244085 2.092154-4.244085C2.580324-4.244085 3.148194-3.855542 3.148194-2.968867V-2.600249C2.6401-2.570361 1.942715-2.540473 1.315068-2.241594C.56787-1.902864 .318804-1.384807 .318804-.946451C.318804-.139477 1.285181 .109589 1.912827 .109589C2.570361 .109589 3.028643-.288917 3.217933-.757161C3.257783-.358655 3.526775 .059776 3.995019 .059776C4.204234 .059776 4.811955-.079701 4.811955-.886675ZM3.148194-1.39477C3.148194-.448319 2.430884-.109589 1.982565-.109589C1.494396-.109589 1.085928-.458281 1.085928-.956413C1.085928-1.504359 1.504359-2.331258 3.148194-2.391034V-1.39477Z" id="g0-28"></path><path d="M4.134496-1.185554C4.134496-1.285181 4.054795-1.305106 4.004981-1.305106C3.915318-1.305106 3.895392-1.24533 3.875467-1.165629C3.526775-.139477 2.630137-.139477 2.530511-.139477C2.032379-.139477 1.633873-.438356 1.404732-.806974C1.105853-1.285181 1.105853-1.942715 1.105853-2.30137H3.88543C4.104608-2.30137 4.134496-2.30137 4.134496-2.510585C4.134496-3.496887 3.596513-4.463263 2.351183-4.463263C1.195517-4.463263 .278954-3.437111 .278954-2.191781C.278954-.856787 1.325031 .109589 2.470735 .109589C3.686177 .109589 4.134496-.996264 4.134496-1.185554ZM3.476961-2.510585H1.115816C1.175592-3.995019 2.012453-4.244085 2.351183-4.244085C3.377335-4.244085 3.476961-2.899128 3.476961-2.510585Z" id="g0-50"></path><path d="M4.83188-4.024907C4.83188-4.194271 4.712329-4.513076 4.323786-4.513076C4.124533-4.513076 3.686177-4.4533 3.267746-4.044832C2.849315-4.373599 2.430884-4.403487 2.211706-4.403487C1.285181-4.403487 .597758-3.716065 .597758-2.948941C.597758-2.510585 .816936-2.132005 1.066002-1.92279C.936488-1.77335 .757161-1.444583 .757161-1.09589C.757161-.787049 .886675-.408468 1.195517-.209215C.597758-.039851 .278954 .388543 .278954 .787049C.278954 1.504359 1.265255 2.052304 2.480697 2.052304C3.656289 2.052304 4.692403 1.544209 4.692403 .767123C4.692403 .418431 4.552927-.089664 4.044832-.368618C3.516812-.647572 2.938979-.647572 2.331258-.647572C2.082192-.647572 1.653798-.647572 1.58406-.657534C1.265255-.697385 1.05604-1.006227 1.05604-1.325031C1.05604-1.364882 1.05604-1.594022 1.225405-1.793275C1.613948-1.514321 2.022416-1.484433 2.211706-1.484433C3.138232-1.484433 3.825654-2.171856 3.825654-2.938979C3.825654-3.307597 3.666252-3.676214 3.417186-3.905355C3.775841-4.244085 4.134496-4.293898 4.313823-4.293898C4.313823-4.293898 4.383562-4.293898 4.41345-4.283935C4.303861-4.244085 4.254047-4.134496 4.254047-4.014944C4.254047-3.845579 4.383562-3.726027 4.542964-3.726027C4.64259-3.726027 4.83188-3.795766 4.83188-4.024907ZM3.078456-2.948941C3.078456-2.67995 3.068493-2.361146 2.919054-2.11208C2.839352-1.992528 2.610212-1.713574 2.211706-1.713574C1.344956-1.713574 1.344956-2.709838 1.344956-2.938979C1.344956-3.20797 1.354919-3.526775 1.504359-3.775841C1.58406-3.895392 1.8132-4.174346 2.211706-4.174346C3.078456-4.174346 3.078456-3.178082 3.078456-2.948941ZM4.174346 .787049C4.174346 1.325031 3.466999 1.823163 2.49066 1.823163C1.484433 1.823163 .797011 1.315068 .797011 .787049C.797011 .328767 1.175592-.039851 1.613948-.069738H2.201743C3.058531-.069738 4.174346-.069738 4.174346 .787049Z" id="g0-59"></path><path d="M2.460772 0V-.308842C1.803238-.308842 1.763387-.358655 1.763387-.747198V-4.403487L.368618-4.293898V-3.985056C1.016189-3.985056 1.105853-3.92528 1.105853-3.437111V-.757161C1.105853-.308842 .996264-.308842 .328767-.308842V0L1.424658-.029888C1.77335-.029888 2.122042-.009963 2.460772 0ZM1.912827-6.017435C1.912827-6.286426 1.683686-6.545455 1.384807-6.545455C1.046077-6.545455 .846824-6.266501 .846824-6.017435C.846824-5.748443 1.075965-5.489415 1.374844-5.489415C1.713574-5.489415 1.912827-5.768369 1.912827-6.017435Z" id="g0-66"></path><path d="M2.540473 0V-.308842C1.872976-.308842 1.763387-.308842 1.763387-.757161V-6.914072L.328767-6.804483V-6.495641C1.026152-6.495641 1.105853-6.425903 1.105853-5.937733V-.757161C1.105853-.308842 .996264-.308842 .328767-.308842V0L1.43462-.029888L2.540473 0Z" id="g0-72"></path><path d="M5.330012 0V-.308842C4.811955-.308842 4.562889-.308842 4.552927-.607721V-2.510585C4.552927-3.367372 4.552927-3.676214 4.244085-4.034869C4.104608-4.204234 3.775841-4.403487 3.198007-4.403487C2.470735-4.403487 2.002491-3.975093 1.723537-3.35741V-4.403487L.318804-4.293898V-3.985056C1.016189-3.985056 1.09589-3.915318 1.09589-3.427148V-.757161C1.09589-.308842 .986301-.308842 .318804-.308842V0L1.444583-.029888L2.560399 0V-.308842C1.892902-.308842 1.783313-.308842 1.783313-.757161V-2.590286C1.783313-3.626401 2.49066-4.184309 3.128269-4.184309C3.755915-4.184309 3.865504-3.646326 3.865504-3.078456V-.757161C3.865504-.308842 3.755915-.308842 3.088418-.308842V0L4.214197-.029888L5.330012 0Z" id="g0-77"></path><path d="M4.692403-2.132005C4.692403-3.407223 3.696139-4.463263 2.49066-4.463263C1.24533-4.463263 .278954-3.377335 .278954-2.132005C.278954-.846824 1.315068 .109589 2.480697 .109589C3.686177 .109589 4.692403-.86675 4.692403-2.132005ZM3.865504-2.211706C3.865504-1.853051 3.865504-1.315068 3.646326-.876712C3.427148-.428394 2.988792-.139477 2.49066-.139477C2.062267-.139477 1.62391-.348692 1.354919-.806974C1.105853-1.24533 1.105853-1.853051 1.105853-2.211706C1.105853-2.600249 1.105853-3.138232 1.344956-3.576588C1.613948-4.034869 2.082192-4.244085 2.480697-4.244085C2.919054-4.244085 3.347447-4.024907 3.606476-3.596513S3.865504-2.590286 3.865504-2.211706Z" id="g0-81"></path><path d="M3.626401-3.795766C3.626401-4.11457 3.317559-4.403487 2.889166-4.403487C2.161893-4.403487 1.803238-3.73599 1.663761-3.307597V-4.403487L.278954-4.293898V-3.985056C.976339-3.985056 1.05604-3.915318 1.05604-3.427148V-.757161C1.05604-.308842 .946451-.308842 .278954-.308842V0L1.414695-.029888C1.8132-.029888 2.281445-.029888 2.67995 0V-.308842H2.470735C1.733499-.308842 1.713574-.418431 1.713574-.777086V-2.311333C1.713574-3.297634 2.132005-4.184309 2.889166-4.184309C2.958904-4.184309 2.978829-4.184309 2.998755-4.174346C2.968867-4.164384 2.769614-4.044832 2.769614-3.785803C2.769614-3.506849 2.978829-3.35741 3.198007-3.35741C3.377335-3.35741 3.626401-3.476961 3.626401-3.795766Z" id="g0-96"></path><path d="M3.58655-1.275218C3.58655-1.803238 3.287671-2.102117 3.16812-2.221669C2.839352-2.540473 2.450809-2.620174 2.032379-2.699875C1.474471-2.809465 .806974-2.938979 .806974-3.516812C.806974-3.865504 1.066002-4.273973 1.92279-4.273973C3.01868-4.273973 3.068493-3.377335 3.088418-3.068493C3.098381-2.978829 3.20797-2.978829 3.20797-2.978829C3.337484-2.978829 3.337484-3.028643 3.337484-3.217933V-4.224159C3.337484-4.393524 3.337484-4.463263 3.227895-4.463263C3.178082-4.463263 3.158157-4.463263 3.028643-4.343711C2.998755-4.303861 2.899128-4.214197 2.859278-4.184309C2.480697-4.463263 2.072229-4.463263 1.92279-4.463263C.707347-4.463263 .328767-3.795766 .328767-3.237858C.328767-2.889166 .488169-2.610212 .757161-2.391034C1.075965-2.132005 1.354919-2.072229 2.072229-1.932752C2.291407-1.892902 3.108344-1.733499 3.108344-1.016189C3.108344-.508095 2.759651-.109589 1.982565-.109589C1.145704-.109589 .787049-.67746 .597758-1.524284C.56787-1.653798 .557908-1.693649 .458281-1.693649C.328767-1.693649 .328767-1.62391 .328767-1.444583V-.129514C.328767 .039851 .328767 .109589 .438356 .109589C.488169 .109589 .498132 .099626 .687422-.089664C.707347-.109589 .707347-.129514 .886675-.318804C1.325031 .099626 1.77335 .109589 1.982565 .109589C3.128269 .109589 3.58655-.557908 3.58655-1.275218Z" id="g0-98"></path><path d="M3.307597-1.235367V-1.803238H3.058531V-1.255293C3.058531-.518057 2.759651-.139477 2.391034-.139477C1.723537-.139477 1.723537-1.046077 1.723537-1.215442V-3.985056H3.148194V-4.293898H1.723537V-6.127024H1.474471C1.464508-5.310087 1.165629-4.244085 .18929-4.204234V-3.985056H1.036115V-1.235367C1.036115-.009963 1.96264 .109589 2.321295 .109589C3.028643 .109589 3.307597-.597758 3.307597-1.235367Z" id="g0-105"></path></defs><g id="page1"><g stroke-miterlimit="10" transform="translate(82.4844,-59.247822)scale(0.996264,-0.996264)"><g fill="#000" stroke="#000"><g stroke-width="0.4"><g stroke-width="0.7"><path d="M -72.85823 0.0 C -72.85823 6.90364 -78.45459 12.5 -85.35823 12.5 C -92.26187 12.5 -97.85823 6.90364 -97.85823 0.0 C -97.85823 -6.90364 -92.26187 -12.5 -85.35823 -12.5 C -78.45459 -12.5 -72.85823 -6.90364 -72.85823 0.0 Z M -85.35823 0.0" fill="none"></path><g transform="translate(-89.26274,-3.41666)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(82.4844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="82.4844" xlink:href="#g1-80" y="-59.247822"></use></g></g></g></g><path d="M -101.31097 -28.45274 C -101.31097 -21.5491 -106.90733 -15.95274 -113.81097 -15.95274 C -120.71461 -15.95274 -126.31097 -21.5491 -126.31097 -28.45274 C -126.31097 -35.35638 -120.71461 -40.95274 -113.81097 -40.95274 C -106.90733 -40.95274 -101.31097 -35.35638 -101.31097 -28.45274 Z M -113.81097 -28.45274" fill="none"></path><g transform="translate(-118.34569,-31.8694)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(82.4844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="82.4844" xlink:href="#g1-88" y="-59.247822"></use></g></g></g></g><path d="M -129.76372 -56.90549 C -129.76372 -50.00185 -135.36008 -44.40549 -142.26372 -44.40549 C -149.16736 -44.40549 -154.76372 -50.00185 -154.76372 -56.90549 C -154.76372 -63.80913 -149.16736 -69.40549 -142.26372 -69.40549 C -135.36008 -69.40549 -129.76372 -63.80913 -129.76372 -56.90549 Z M -142.26372 -56.90549" fill="none"></path><g transform="translate(-145.12135,-59.05826)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(82.4844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="82.4844" xlink:href="#g1-120" y="-59.247822"></use></g></g></g></g><path d="M -72.85823 -56.90549 C -72.85823 -50.00185 -78.45459 -44.40549 -85.35823 -44.40549 C -92.26187 -44.40549 -97.85823 -50.00185 -97.85823 -56.90549 C -97.85823 -63.80913 -92.26187 -69.40549 -85.35823 -69.40549 C -78.45459 -69.40549 -72.85823 -63.80913 -72.85823 -56.90549 Z M -85.35823 -56.90549" fill="none"></path><g transform="translate(-87.98903,-58.08604)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(82.4844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="82.4844" xlink:href="#g1-121" y="-59.247822"></use></g></g></g></g><path d="M -44.40549 -28.45274 C -44.40549 -21.5491 -50.00185 -15.95274 -56.90549 -15.95274 C -63.80913 -15.95274 -69.40549 -21.5491 -69.40549 -28.45274 C -69.40549 -35.35638 -63.80913 -40.95274 -56.90549 -40.95274 C -50.00185 -40.95274 -44.40549 -35.35638 -44.40549 -28.45274 Z M -56.90549 -28.45274" fill="none"></path><g transform="translate(-59.45064,-30.60551)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(82.4844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="82.4844" xlink:href="#g1-122" y="-59.247822"></use></g></g></g></g><path d="M 97.85823 0.0 C 97.85823 6.90364 92.26187 12.5 85.35823 12.5 C 78.45459 12.5 72.85823 6.90364 72.85823 0.0 C 72.85823 -6.90364 78.45459 -12.5 85.35823 -12.5 C 92.26187 -12.5 97.85823 -6.90364 97.85823 0.0 Z M 85.35823 0.0" fill="none"></path><g transform="translate(80.82352,-3.41666)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(82.4844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="82.4844" xlink:href="#g1-88" y="-59.247822"></use></g></g></g></g><path d="M 126.31097 -28.45274 C 126.31097 -21.5491 120.71461 -15.95274 113.81097 -15.95274 C 106.90733 -15.95274 101.31097 -21.5491 101.31097 -28.45274 C 101.31097 -35.35638 106.90733 -40.95274 113.81097 -40.95274 C 120.71461 -40.95274 126.31097 -35.35638 126.31097 -28.45274 Z M 113.81097 -28.45274" fill="none"></path><g transform="translate(109.90646,-31.8694)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(82.4844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="82.4844" xlink:href="#g1-80" y="-59.247822"></use></g></g></g></g><path d="M 69.40549 -28.45274 C 69.40549 -21.5491 63.80913 -15.95274 56.90549 -15.95274 C 50.00185 -15.95274 44.40549 -21.5491 44.40549 -28.45274 C 44.40549 -35.35638 50.00185 -40.95274 56.90549 -40.95274 C 63.80913 -40.95274 69.40549 -35.35638 69.40549 -28.45274 Z M 56.90549 -28.45274" fill="none"></path><g transform="translate(54.04785,-30.60551)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(82.4844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="82.4844" xlink:href="#g1-120" y="-59.247822"></use></g></g></g></g><path d="M 97.85823 -56.90549 C 97.85823 -50.00185 92.26187 -44.40549 85.35823 -44.40549 C 78.45459 -44.40549 72.85823 -50.00185 72.85823 -56.90549 C 72.85823 -63.80913 78.45459 -69.40549 85.35823 -69.40549 C 92.26187 -69.40549 97.85823 -63.80913 97.85823 -56.90549 Z M 85.35823 -56.90549" fill="none"></path><g transform="translate(82.72743,-58.08604)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(82.4844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="82.4844" xlink:href="#g1-121" y="-59.247822"></use></g></g></g></g><path d="M 154.76372 -56.90549 C 154.76372 -50.00185 149.16736 -44.40549 142.26372 -44.40549 C 135.36008 -44.40549 129.76372 -50.00185 129.76372 -56.90549 C 129.76372 -63.80913 135.36008 -69.40549 142.26372 -69.40549 C 149.16736 -69.40549 154.76372 -63.80913 154.76372 -56.90549 Z M 142.26372 -56.90549" fill="none"></path><g transform="translate(139.71857,-59.05826)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(82.4844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="82.4844" xlink:href="#g1-122" y="-59.247822"></use></g></g></g></g><path d="M -28.45274 -28.45274 L 24.40657 -28.45274" fill="none"></path><g transform="translate(22.30711,-28.45274)"><g stroke-dasharray="none" stroke-dashoffset="0.0"> <g stroke-linejoin="round"> <path d=" M 4.84563 0.0 L 0.96873 1.46368 L 2.24945 0.0 L 0.96873 -1.46368 Z  "></path> </g> </g></g><g transform="translate(-31.435,-24.09277)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(82.4844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="82.4844" xlink:href="#g0-98" y="-59.247822"></use><use x="86.409683" xlink:href="#g0-66" y="-59.247822"></use><use x="89.179295" xlink:href="#g0-77" y="-59.247822"></use><use x="94.718521" xlink:href="#g0-59" y="-59.247822"></use><use x="99.699841" xlink:href="#g0-72" y="-59.247822"></use><use x="102.469454" xlink:href="#g0-50" y="-59.247822"></use><use x="110.210429" xlink:href="#g0-96" y="-59.247822"></use><use x="114.115782" xlink:href="#g0-81" y="-59.247822"></use><use x="119.097102" xlink:href="#g0-105" y="-59.247822"></use><use x="122.972569" xlink:href="#g0-28" y="-59.247822"></use><use x="127.953889" xlink:href="#g0-105" y="-59.247822"></use><use x="131.829355" xlink:href="#g0-66" y="-59.247822"></use><use x="134.598968" xlink:href="#g0-81" y="-59.247822"></use><use x="139.580288" xlink:href="#g0-77" y="-59.247822"></use></g></g></g></g><path d="M -94.4092 -9.05096 L -104.0529 -18.69467" fill="none"></path><path d="M -122.86194 -37.50371 L -132.50565 -47.14742" fill="none"></path><path d="M -104.76001 -37.50371 L -95.1163 -47.14742" fill="none"></path><path d="M -76.30727 -9.05096 L -66.66356 -18.69467" fill="none"></path><path d="M 94.4092 -9.05096 L 104.0529 -18.69467" fill="none"></path><path d="M 76.30727 -9.05096 L 66.66356 -18.69467" fill="none"></path><path d="M 104.76001 -37.50371 L 95.1163 -47.14742" fill="none"></path><path d="M 122.86194 -37.50371 L 132.50565 -47.14742" fill="none"></path></g></g></g></g></g></svg></div>
<div class="arithmatex">\[\begin{gather}
    \hat{c_i} = 1 + \operatorname{rank}_2(X) - \operatorname{rank}_1(X) + \operatorname{rank}_2(P) - \operatorname{rank}_1(P) \leqslant 1 + \operatorname{rank}_2(X) - \operatorname{rank}_1(X) \\
    (\operatorname{rank}_2(P) \leqslant \operatorname{rank}_1(P)) \\
\end{gather}\]</div>
</div>
<div class="tabbed-block">
<p></p><div style="text-align: center; zoom: 1.5;"><!-- This file was generated by dvisvgm 2.13.3 --><svg height="110.543701pt" version="1.1" viewbox="-72.000004 -72.000008 357.157669 110.543701" width="357.157669pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M7.571606-6.924035C7.571606-6.953923 7.551681-7.023661 7.462017-7.023661C7.43213-7.023661 7.422167-7.013699 7.312578-6.90411L6.615193-6.136986C6.525529-6.276463 6.067248-7.023661 4.961395-7.023661C2.739726-7.023661 .498132-4.821918 .498132-2.510585C.498132-.926526 1.603985 .219178 3.217933 .219178C3.656289 .219178 4.104608 .129514 4.463263-.019925C4.961395-.219178 5.150685-.428394 5.330012-.627646C5.419676-.37858 5.678705-.009963 5.778331-.009963C5.828144-.009963 5.84807-.039851 5.84807-.049813C5.867995-.069738 5.967621-.448319 6.017435-.657534L6.206725-1.424658C6.246575-1.594022 6.296389-1.763387 6.336239-1.932752C6.445828-2.381071 6.455791-2.400996 7.023661-2.410959C7.073474-2.410959 7.183064-2.420922 7.183064-2.610212C7.183064-2.67995 7.13325-2.719801 7.053549-2.719801C6.824408-2.719801 6.236613-2.689913 6.007472-2.689913C5.69863-2.689913 4.921544-2.719801 4.612702-2.719801C4.523039-2.719801 4.403487-2.719801 4.403487-2.520548C4.403487-2.410959 4.483188-2.410959 4.702366-2.410959C4.712329-2.410959 5.001245-2.410959 5.230386-2.391034C5.489415-2.361146 5.539228-2.331258 5.539228-2.201743C5.539228-2.11208 5.429639-1.663761 5.330012-1.295143C5.051059-.199253 3.755915-.089664 3.407223-.089664C2.450809-.089664 1.404732-.657534 1.404732-2.181818C1.404732-2.49066 1.504359-4.134496 2.550436-5.429639C3.088418-6.107098 4.054795-6.714819 5.041096-6.714819C6.057285-6.714819 6.645081-5.947696 6.645081-4.79203C6.645081-4.393524 6.615193-4.383562 6.615193-4.283935S6.724782-4.184309 6.764633-4.184309C6.894147-4.184309 6.894147-4.204234 6.94396-4.383562L7.571606-6.924035Z" id="g1-71"></path><path d="M3.01868-3.148194H4.712329C6.127024-3.148194 7.511831-4.184309 7.511831-5.300125C7.511831-6.067248 6.854296-6.804483 5.549191-6.804483H2.321295C2.132005-6.804483 2.022416-6.804483 2.022416-6.615193C2.022416-6.495641 2.11208-6.495641 2.311333-6.495641C2.440847-6.495641 2.620174-6.485679 2.739726-6.475716C2.899128-6.455791 2.958904-6.425903 2.958904-6.316314C2.958904-6.276463 2.948941-6.246575 2.919054-6.127024L1.58406-.777086C1.484433-.388543 1.464508-.308842 .67746-.308842C.508095-.308842 .398506-.308842 .398506-.119552C.398506 0 .518057 0 .547945 0C.826899 0 1.534247-.029888 1.8132-.029888C2.022416-.029888 2.241594-.019925 2.450809-.019925C2.669988-.019925 2.889166 0 3.098381 0C3.16812 0 3.297634 0 3.297634-.199253C3.297634-.308842 3.20797-.308842 3.01868-.308842C2.650062-.308842 2.371108-.308842 2.371108-.488169C2.371108-.547945 2.391034-.597758 2.400996-.657534L3.01868-3.148194ZM3.73599-6.117061C3.825654-6.465753 3.845579-6.495641 4.273973-6.495641H5.230386C6.057285-6.495641 6.585305-6.22665 6.585305-5.539228C6.585305-5.150685 6.386052-4.293898 5.997509-3.935243C5.499377-3.486924 4.901619-3.407223 4.463263-3.407223H3.058531L3.73599-6.117061Z" id="g1-80"></path><path d="M4.83188-4.094645L3.995019-6.07721C3.965131-6.156912 3.945205-6.196762 3.945205-6.206725C3.945205-6.266501 4.11457-6.455791 4.533001-6.495641C4.632628-6.505604 4.732254-6.515567 4.732254-6.684932C4.732254-6.804483 4.612702-6.804483 4.582814-6.804483C4.174346-6.804483 3.745953-6.774595 3.327522-6.774595C3.078456-6.774595 2.460772-6.804483 2.211706-6.804483C2.15193-6.804483 2.032379-6.804483 2.032379-6.60523C2.032379-6.495641 2.132005-6.495641 2.261519-6.495641C2.859278-6.495641 2.919054-6.396015 3.008717-6.176837L4.184309-3.39726L2.082192-1.135741L1.952677-1.026152C1.464508-.498132 .996264-.33873 .488169-.308842C.358655-.298879 .268991-.298879 .268991-.109589C.268991-.099626 .268991 0 .398506 0C.697385 0 1.026152-.029888 1.334994-.029888C1.703611-.029888 2.092154 0 2.450809 0C2.510585 0 2.630137 0 2.630137-.199253C2.630137-.298879 2.530511-.308842 2.510585-.308842C2.420922-.318804 2.11208-.33873 2.11208-.617684C2.11208-.777086 2.261519-.936488 2.381071-1.066002L3.39726-2.141968L4.293898-3.118306L5.300125-.737235C5.339975-.627646 5.349938-.617684 5.349938-.597758C5.349938-.518057 5.160648-.348692 4.772105-.308842C4.662516-.298879 4.572852-.288917 4.572852-.119552C4.572852 0 4.682441 0 4.722291 0C5.001245 0 5.69863-.029888 5.977584-.029888C6.22665-.029888 6.834371 0 7.083437 0C7.153176 0 7.272727 0 7.272727-.18929C7.272727-.308842 7.173101-.308842 7.0934-.308842C6.425903-.318804 6.405978-.348692 6.236613-.747198C5.84807-1.673724 5.180573-3.227895 4.951432-3.825654C5.628892-4.523039 6.674969-5.708593 6.993773-5.987547C7.28269-6.22665 7.66127-6.465753 8.259029-6.495641C8.388543-6.505604 8.478207-6.505604 8.478207-6.694894C8.478207-6.704857 8.478207-6.804483 8.348692-6.804483C8.049813-6.804483 7.721046-6.774595 7.412204-6.774595C7.043587-6.774595 6.665006-6.804483 6.306351-6.804483C6.246575-6.804483 6.117061-6.804483 6.117061-6.60523C6.117061-6.535492 6.166874-6.505604 6.236613-6.495641C6.326276-6.485679 6.635118-6.465753 6.635118-6.1868C6.635118-6.047323 6.525529-5.917808 6.445828-5.828144L4.83188-4.094645Z" id="g1-88"></path><path d="M4.60274-3.377335C4.652553-3.596513 4.752179-3.965131 4.752179-4.024907C4.752179-4.204234 4.612702-4.293898 4.463263-4.293898C4.343711-4.293898 4.164384-4.214197 4.094645-4.014944C4.064757-3.945205 3.596513-2.042341 3.526775-1.783313C3.457036-1.484433 3.437111-1.305106 3.437111-1.125778C3.437111-1.016189 3.437111-.996264 3.447073-.946451C3.217933-.418431 2.919054-.109589 2.530511-.109589C1.733499-.109589 1.733499-.846824 1.733499-1.016189C1.733499-1.334994 1.783313-1.723537 2.251557-2.948941C2.361146-3.247821 2.420922-3.387298 2.420922-3.58655C2.420922-4.034869 2.092154-4.403487 1.603985-4.403487C.657534-4.403487 .288917-2.958904 .288917-2.86924C.288917-2.769614 .388543-2.769614 .408468-2.769614C.508095-2.769614 .518057-2.789539 .56787-2.948941C.836862-3.875467 1.225405-4.184309 1.574097-4.184309C1.663761-4.184309 1.823163-4.174346 1.823163-3.855542C1.823163-3.606476 1.713574-3.327522 1.643836-3.158157C1.205479-1.982565 1.085928-1.524284 1.085928-1.145704C1.085928-.239103 1.753425 .109589 2.500623 .109589C2.669988 .109589 3.138232 .109589 3.536737-.587796C3.795766 .049813 4.483188 .109589 4.782067 .109589C5.529265 .109589 5.967621-.518057 6.22665-1.115816C6.56538-1.892902 6.884184-3.227895 6.884184-3.706102C6.884184-4.254047 6.615193-4.403487 6.445828-4.403487C6.196762-4.403487 5.947696-4.144458 5.947696-3.92528C5.947696-3.795766 6.007472-3.73599 6.097136-3.656289C6.206725-3.5467 6.455791-3.287671 6.455791-2.809465C6.455791-2.470735 6.166874-1.494396 5.907846-.986301C5.648817-.458281 5.300125-.109589 4.811955-.109589C4.343711-.109589 4.07472-.408468 4.07472-.976339C4.07472-1.255293 4.144458-1.564134 4.184309-1.703611L4.60274-3.377335Z" id="g1-119"></path><path d="M3.327522-3.008717C3.387298-3.267746 3.616438-4.184309 4.313823-4.184309C4.363636-4.184309 4.60274-4.184309 4.811955-4.054795C4.533001-4.004981 4.333748-3.755915 4.333748-3.516812C4.333748-3.35741 4.443337-3.16812 4.712329-3.16812C4.931507-3.16812 5.250311-3.347447 5.250311-3.745953C5.250311-4.26401 4.662516-4.403487 4.323786-4.403487C3.745953-4.403487 3.39726-3.875467 3.277709-3.646326C3.028643-4.303861 2.49066-4.403487 2.201743-4.403487C1.165629-4.403487 .597758-3.118306 .597758-2.86924C.597758-2.769614 .697385-2.769614 .71731-2.769614C.797011-2.769614 .826899-2.789539 .846824-2.879203C1.185554-3.935243 1.843088-4.184309 2.181818-4.184309C2.371108-4.184309 2.719801-4.094645 2.719801-3.516812C2.719801-3.20797 2.550436-2.540473 2.181818-1.145704C2.022416-.52802 1.673724-.109589 1.235367-.109589C1.175592-.109589 .946451-.109589 .737235-.239103C.986301-.288917 1.205479-.498132 1.205479-.777086C1.205479-1.046077 .986301-1.125778 .836862-1.125778C.537983-1.125778 .288917-.86675 .288917-.547945C.288917-.089664 .787049 .109589 1.225405 .109589C1.882939 .109589 2.241594-.587796 2.271482-.647572C2.391034-.278954 2.749689 .109589 3.347447 .109589C4.373599 .109589 4.941469-1.175592 4.941469-1.424658C4.941469-1.524284 4.851806-1.524284 4.821918-1.524284C4.732254-1.524284 4.712329-1.484433 4.692403-1.414695C4.363636-.348692 3.686177-.109589 3.367372-.109589C2.978829-.109589 2.819427-.428394 2.819427-.767123C2.819427-.986301 2.879203-1.205479 2.988792-1.643836L3.327522-3.008717Z" id="g1-120"></path><path d="M4.841843-3.795766C4.881694-3.935243 4.881694-3.955168 4.881694-4.024907C4.881694-4.204234 4.742217-4.293898 4.592777-4.293898C4.493151-4.293898 4.333748-4.234122 4.244085-4.084682C4.224159-4.034869 4.144458-3.726027 4.104608-3.5467C4.034869-3.287671 3.965131-3.01868 3.905355-2.749689L3.457036-.956413C3.417186-.806974 2.988792-.109589 2.331258-.109589C1.823163-.109589 1.713574-.547945 1.713574-.916563C1.713574-1.374844 1.882939-1.992528 2.221669-2.86924C2.381071-3.277709 2.420922-3.387298 2.420922-3.58655C2.420922-4.034869 2.102117-4.403487 1.603985-4.403487C.657534-4.403487 .288917-2.958904 .288917-2.86924C.288917-2.769614 .388543-2.769614 .408468-2.769614C.508095-2.769614 .518057-2.789539 .56787-2.948941C.836862-3.88543 1.235367-4.184309 1.574097-4.184309C1.653798-4.184309 1.823163-4.184309 1.823163-3.865504C1.823163-3.616438 1.723537-3.35741 1.653798-3.16812C1.255293-2.11208 1.075965-1.544209 1.075965-1.075965C1.075965-.18929 1.703611 .109589 2.291407 .109589C2.67995 .109589 3.01868-.059776 3.297634-.33873C3.16812 .179328 3.048568 .667497 2.650062 1.195517C2.391034 1.534247 2.012453 1.823163 1.554172 1.823163C1.414695 1.823163 .966376 1.793275 .797011 1.404732C.956413 1.404732 1.085928 1.404732 1.225405 1.285181C1.325031 1.195517 1.424658 1.066002 1.424658 .876712C1.424658 .56787 1.155666 .52802 1.05604 .52802C.826899 .52802 .498132 .687422 .498132 1.175592C.498132 1.673724 .936488 2.042341 1.554172 2.042341C2.580324 2.042341 3.606476 1.135741 3.88543 .009963L4.841843-3.795766Z" id="g1-121"></path><path d="M1.325031-.826899C1.863014-1.404732 2.15193-1.653798 2.510585-1.96264C2.510585-1.972603 3.128269-2.500623 3.486924-2.859278C4.433375-3.785803 4.652553-4.26401 4.652553-4.303861C4.652553-4.403487 4.562889-4.403487 4.542964-4.403487C4.473225-4.403487 4.443337-4.383562 4.393524-4.293898C4.094645-3.815691 3.88543-3.656289 3.646326-3.656289S3.287671-3.805729 3.138232-3.975093C2.948941-4.204234 2.779577-4.403487 2.450809-4.403487C1.703611-4.403487 1.24533-3.476961 1.24533-3.267746C1.24533-3.217933 1.275218-3.158157 1.364882-3.158157S1.474471-3.20797 1.494396-3.267746C1.683686-3.726027 2.261519-3.73599 2.34122-3.73599C2.550436-3.73599 2.739726-3.666252 2.968867-3.58655C3.367372-3.437111 3.476961-3.437111 3.73599-3.437111C3.377335-3.008717 2.540473-2.291407 2.351183-2.132005L1.454545-1.295143C.777086-.627646 .428394-.059776 .428394 .009963C.428394 .109589 .52802 .109589 .547945 .109589C.627646 .109589 .647572 .089664 .707347-.019925C.936488-.368618 1.235367-.637609 1.554172-.637609C1.783313-.637609 1.882939-.547945 2.132005-.259029C2.30137-.049813 2.480697 .109589 2.769614 .109589C3.755915 .109589 4.333748-1.155666 4.333748-1.424658C4.333748-1.474471 4.293898-1.524284 4.214197-1.524284C4.124533-1.524284 4.104608-1.464508 4.07472-1.39477C3.845579-.747198 3.20797-.557908 2.879203-.557908C2.67995-.557908 2.500623-.617684 2.291407-.687422C1.952677-.816936 1.803238-.856787 1.594022-.856787C1.574097-.856787 1.414695-.856787 1.325031-.826899Z" id="g1-122"></path><path d="M4.811955-.886675V-1.444583H4.562889V-.886675C4.562889-.308842 4.313823-.249066 4.204234-.249066C3.875467-.249066 3.835616-.697385 3.835616-.747198V-2.739726C3.835616-3.158157 3.835616-3.5467 3.476961-3.915318C3.088418-4.303861 2.590286-4.463263 2.11208-4.463263C1.295143-4.463263 .607721-3.995019 .607721-3.337484C.607721-3.038605 .806974-2.86924 1.066002-2.86924C1.344956-2.86924 1.524284-3.068493 1.524284-3.327522C1.524284-3.447073 1.474471-3.775841 1.016189-3.785803C1.285181-4.134496 1.77335-4.244085 2.092154-4.244085C2.580324-4.244085 3.148194-3.855542 3.148194-2.968867V-2.600249C2.6401-2.570361 1.942715-2.540473 1.315068-2.241594C.56787-1.902864 .318804-1.384807 .318804-.946451C.318804-.139477 1.285181 .109589 1.912827 .109589C2.570361 .109589 3.028643-.288917 3.217933-.757161C3.257783-.358655 3.526775 .059776 3.995019 .059776C4.204234 .059776 4.811955-.079701 4.811955-.886675ZM3.148194-1.39477C3.148194-.448319 2.430884-.109589 1.982565-.109589C1.494396-.109589 1.085928-.458281 1.085928-.956413C1.085928-1.504359 1.504359-2.331258 3.148194-2.391034V-1.39477Z" id="g0-28"></path><path d="M5.190535-2.15193C5.190535-3.417186 4.214197-4.403487 3.078456-4.403487C2.30137-4.403487 1.872976-3.935243 1.713574-3.755915V-6.914072L.278954-6.804483V-6.495641C.976339-6.495641 1.05604-6.425903 1.05604-5.937733V0H1.305106L1.663761-.617684C1.8132-.388543 2.231631 .109589 2.968867 .109589C4.154421 .109589 5.190535-.86675 5.190535-2.15193ZM4.363636-2.161893C4.363636-1.793275 4.343711-1.195517 4.054795-.747198C3.845579-.438356 3.466999-.109589 2.929016-.109589C2.480697-.109589 2.122042-.348692 1.882939-.71731C1.743462-.926526 1.743462-.956413 1.743462-1.135741V-3.188045C1.743462-3.377335 1.743462-3.387298 1.853051-3.5467C2.241594-4.104608 2.789539-4.184309 3.028643-4.184309C3.476961-4.184309 3.835616-3.92528 4.07472-3.5467C4.333748-3.138232 4.363636-2.570361 4.363636-2.161893Z" id="g0-35"></path><path d="M5.250311 0V-.308842C4.552927-.308842 4.473225-.37858 4.473225-.86675V-6.914072L3.038605-6.804483V-6.495641C3.73599-6.495641 3.815691-6.425903 3.815691-5.937733V-3.785803C3.526775-4.144458 3.098381-4.403487 2.560399-4.403487C1.384807-4.403487 .33873-3.427148 .33873-2.141968C.33873-.876712 1.315068 .109589 2.450809 .109589C3.088418 .109589 3.536737-.229141 3.785803-.547945V.109589L5.250311 0ZM3.785803-1.175592C3.785803-.996264 3.785803-.976339 3.676214-.806974C3.377335-.328767 2.929016-.109589 2.500623-.109589C2.052304-.109589 1.693649-.368618 1.454545-.747198C1.195517-1.155666 1.165629-1.723537 1.165629-2.132005C1.165629-2.500623 1.185554-3.098381 1.474471-3.5467C1.683686-3.855542 2.062267-4.184309 2.600249-4.184309C2.948941-4.184309 3.367372-4.034869 3.676214-3.58655C3.785803-3.417186 3.785803-3.39726 3.785803-3.217933V-1.175592Z" id="g0-47"></path><path d="M4.134496-1.185554C4.134496-1.285181 4.054795-1.305106 4.004981-1.305106C3.915318-1.305106 3.895392-1.24533 3.875467-1.165629C3.526775-.139477 2.630137-.139477 2.530511-.139477C2.032379-.139477 1.633873-.438356 1.404732-.806974C1.105853-1.285181 1.105853-1.942715 1.105853-2.30137H3.88543C4.104608-2.30137 4.134496-2.30137 4.134496-2.510585C4.134496-3.496887 3.596513-4.463263 2.351183-4.463263C1.195517-4.463263 .278954-3.437111 .278954-2.191781C.278954-.856787 1.325031 .109589 2.470735 .109589C3.686177 .109589 4.134496-.996264 4.134496-1.185554ZM3.476961-2.510585H1.115816C1.175592-3.995019 2.012453-4.244085 2.351183-4.244085C3.377335-4.244085 3.476961-2.899128 3.476961-2.510585Z" id="g0-50"></path><path d="M2.460772 0V-.308842C1.803238-.308842 1.763387-.358655 1.763387-.747198V-4.403487L.368618-4.293898V-3.985056C1.016189-3.985056 1.105853-3.92528 1.105853-3.437111V-.757161C1.105853-.308842 .996264-.308842 .328767-.308842V0L1.424658-.029888C1.77335-.029888 2.122042-.009963 2.460772 0ZM1.912827-6.017435C1.912827-6.286426 1.683686-6.545455 1.384807-6.545455C1.046077-6.545455 .846824-6.266501 .846824-6.017435C.846824-5.748443 1.075965-5.489415 1.374844-5.489415C1.713574-5.489415 1.912827-5.768369 1.912827-6.017435Z" id="g0-66"></path><path d="M2.540473 0V-.308842C1.872976-.308842 1.763387-.308842 1.763387-.757161V-6.914072L.328767-6.804483V-6.495641C1.026152-6.495641 1.105853-6.425903 1.105853-5.937733V-.757161C1.105853-.308842 .996264-.308842 .328767-.308842V0L1.43462-.029888L2.540473 0Z" id="g0-72"></path><path d="M5.330012 0V-.308842C4.811955-.308842 4.562889-.308842 4.552927-.607721V-2.510585C4.552927-3.367372 4.552927-3.676214 4.244085-4.034869C4.104608-4.204234 3.775841-4.403487 3.198007-4.403487C2.470735-4.403487 2.002491-3.975093 1.723537-3.35741V-4.403487L.318804-4.293898V-3.985056C1.016189-3.985056 1.09589-3.915318 1.09589-3.427148V-.757161C1.09589-.308842 .986301-.308842 .318804-.308842V0L1.444583-.029888L2.560399 0V-.308842C1.892902-.308842 1.783313-.308842 1.783313-.757161V-2.590286C1.783313-3.626401 2.49066-4.184309 3.128269-4.184309C3.755915-4.184309 3.865504-3.646326 3.865504-3.078456V-.757161C3.865504-.308842 3.755915-.308842 3.088418-.308842V0L4.214197-.029888L5.330012 0Z" id="g0-77"></path><path d="M4.692403-2.132005C4.692403-3.407223 3.696139-4.463263 2.49066-4.463263C1.24533-4.463263 .278954-3.377335 .278954-2.132005C.278954-.846824 1.315068 .109589 2.480697 .109589C3.686177 .109589 4.692403-.86675 4.692403-2.132005ZM3.865504-2.211706C3.865504-1.853051 3.865504-1.315068 3.646326-.876712C3.427148-.428394 2.988792-.139477 2.49066-.139477C2.062267-.139477 1.62391-.348692 1.354919-.806974C1.105853-1.24533 1.105853-1.853051 1.105853-2.211706C1.105853-2.600249 1.105853-3.138232 1.344956-3.576588C1.613948-4.034869 2.082192-4.244085 2.480697-4.244085C2.919054-4.244085 3.347447-4.024907 3.606476-3.596513S3.865504-2.590286 3.865504-2.211706Z" id="g0-81"></path><path d="M3.626401-3.795766C3.626401-4.11457 3.317559-4.403487 2.889166-4.403487C2.161893-4.403487 1.803238-3.73599 1.663761-3.307597V-4.403487L.278954-4.293898V-3.985056C.976339-3.985056 1.05604-3.915318 1.05604-3.427148V-.757161C1.05604-.308842 .946451-.308842 .278954-.308842V0L1.414695-.029888C1.8132-.029888 2.281445-.029888 2.67995 0V-.308842H2.470735C1.733499-.308842 1.713574-.418431 1.713574-.777086V-2.311333C1.713574-3.297634 2.132005-4.184309 2.889166-4.184309C2.958904-4.184309 2.978829-4.184309 2.998755-4.174346C2.968867-4.164384 2.769614-4.044832 2.769614-3.785803C2.769614-3.506849 2.978829-3.35741 3.198007-3.35741C3.377335-3.35741 3.626401-3.476961 3.626401-3.795766Z" id="g0-96"></path><path d="M3.307597-1.235367V-1.803238H3.058531V-1.255293C3.058531-.518057 2.759651-.139477 2.391034-.139477C1.723537-.139477 1.723537-1.046077 1.723537-1.215442V-3.985056H3.148194V-4.293898H1.723537V-6.127024H1.474471C1.464508-5.310087 1.165629-4.244085 .18929-4.204234V-3.985056H1.036115V-1.235367C1.036115-.009963 1.96264 .109589 2.321295 .109589C3.028643 .109589 3.307597-.597758 3.307597-1.235367Z" id="g0-105"></path><path d="M5.330012 0V-.308842C4.632628-.308842 4.552927-.37858 4.552927-.86675V-4.403487L3.088418-4.293898V-3.985056C3.785803-3.985056 3.865504-3.915318 3.865504-3.427148V-1.653798C3.865504-.787049 3.387298-.109589 2.660025-.109589C1.823163-.109589 1.783313-.577833 1.783313-1.09589V-4.403487L.318804-4.293898V-3.985056C1.09589-3.985056 1.09589-3.955168 1.09589-3.068493V-1.574097C1.09589-.797011 1.09589 .109589 2.610212 .109589C3.16812 .109589 3.606476-.169365 3.895392-.787049V.109589L5.330012 0Z" id="g0-109"></path></defs><g id="page1"><g stroke-miterlimit="10" transform="translate(82.4844,-59.247822)scale(0.996264,-0.996264)"><g fill="#000" stroke="#000"><g stroke-width="0.4"><g stroke-width="0.7"><path d="M -72.85823 0.0 C -72.85823 6.90364 -78.45459 12.5 -85.35823 12.5 C -92.26187 12.5 -97.85823 6.90364 -97.85823 0.0 C -97.85823 -6.90364 -92.26187 -12.5 -85.35823 -12.5 C -78.45459 -12.5 -72.85823 -6.90364 -72.85823 0.0 Z M -85.35823 0.0" fill="none"></path><g transform="translate(-89.28947,-3.41666)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(82.4844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="82.4844" xlink:href="#g1-71" y="-59.247822"></use></g></g></g></g><path d="M -101.31097 -28.45274 C -101.31097 -21.5491 -106.90733 -15.95274 -113.81097 -15.95274 C -120.71461 -15.95274 -126.31097 -21.5491 -126.31097 -28.45274 C -126.31097 -35.35638 -120.71461 -40.95274 -113.81097 -40.95274 C -106.90733 -40.95274 -101.31097 -35.35638 -101.31097 -28.45274 Z M -113.81097 -28.45274" fill="none"></path><g transform="translate(-117.71548,-31.8694)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(82.4844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="82.4844" xlink:href="#g1-80" y="-59.247822"></use></g></g></g></g><path d="M -129.76372 -56.90549 C -129.76372 -50.00185 -135.36008 -44.40549 -142.26372 -44.40549 C -149.16736 -44.40549 -154.76372 -50.00185 -154.76372 -56.90549 C -154.76372 -63.80913 -149.16736 -69.40549 -142.26372 -69.40549 C -135.36008 -69.40549 -129.76372 -63.80913 -129.76372 -56.90549 Z M -142.26372 -56.90549" fill="none"></path><g transform="translate(-145.12135,-59.05826)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(82.4844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="82.4844" xlink:href="#g1-120" y="-59.247822"></use></g></g></g></g><path d="M -72.85823 -56.90549 C -72.85823 -50.00185 -78.45459 -44.40549 -85.35823 -44.40549 C -92.26187 -44.40549 -97.85823 -50.00185 -97.85823 -56.90549 C -97.85823 -63.80913 -92.26187 -69.40549 -85.35823 -69.40549 C -78.45459 -69.40549 -72.85823 -63.80913 -72.85823 -56.90549 Z M -85.35823 -56.90549" fill="none"></path><g transform="translate(-89.89294,-60.32214)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(82.4844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="82.4844" xlink:href="#g1-88" y="-59.247822"></use></g></g></g></g><path d="M -44.40549 -28.45274 C -44.40549 -21.5491 -50.00185 -15.95274 -56.90549 -15.95274 C -63.80913 -15.95274 -69.40549 -21.5491 -69.40549 -28.45274 C -69.40549 -35.35638 -63.80913 -40.95274 -56.90549 -40.95274 C -50.00185 -40.95274 -44.40549 -35.35638 -44.40549 -28.45274 Z M -56.90549 -28.45274" fill="none"></path><g transform="translate(-60.61961,-30.60551)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(82.4844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="82.4844" xlink:href="#g1-119" y="-59.247822"></use></g></g></g></g><path d="M -101.31097 -85.35823 C -101.31097 -78.45459 -106.90733 -72.85823 -113.81097 -72.85823 C -120.71461 -72.85823 -126.31097 -78.45459 -126.31097 -85.35823 C -126.31097 -92.26187 -120.71461 -97.85823 -113.81097 -97.85823 C -106.90733 -97.85823 -101.31097 -92.26187 -101.31097 -85.35823 Z M -113.81097 -85.35823" fill="none"></path><g transform="translate(-116.44177,-86.53879)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(82.4844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="82.4844" xlink:href="#g1-121" y="-59.247822"></use></g></g></g></g><path d="M -44.40549 -85.35823 C -44.40549 -78.45459 -50.00185 -72.85823 -56.90549 -72.85823 C -63.80913 -72.85823 -69.40549 -78.45459 -69.40549 -85.35823 C -69.40549 -92.26187 -63.80913 -97.85823 -56.90549 -97.85823 C -50.00185 -97.85823 -44.40549 -92.26187 -44.40549 -85.35823 Z M -56.90549 -85.35823" fill="none"></path><g transform="translate(-59.45064,-87.511)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(82.4844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="82.4844" xlink:href="#g1-122" y="-59.247822"></use></g></g></g></g><path d="M 126.31097 0.0 C 126.31097 6.90364 120.71461 12.5 113.81097 12.5 C 106.90733 12.5 101.31097 6.90364 101.31097 0.0 C 101.31097 -6.90364 106.90733 -12.5 113.81097 -12.5 C 120.71461 -12.5 126.31097 -6.90364 126.31097 0.0 Z M 113.81097 0.0" fill="none"></path><g transform="translate(109.27626,-3.41666)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(82.4844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="82.4844" xlink:href="#g1-88" y="-59.247822"></use></g></g></g></g><path d="M 83.63185 -28.45274 C 83.63185 -21.5491 78.03549 -15.95274 71.13185 -15.95274 C 64.22821 -15.95274 58.63185 -21.5491 58.63185 -28.45274 C 58.63185 -35.35638 64.22821 -40.95274 71.13185 -40.95274 C 78.03549 -40.95274 83.63185 -35.35638 83.63185 -28.45274 Z M 71.13185 -28.45274" fill="none"></path><g transform="translate(67.22734,-31.8694)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(82.4844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="82.4844" xlink:href="#g1-80" y="-59.247822"></use></g></g></g></g><path d="M 168.99008 -28.45274 C 168.99008 -21.5491 163.39372 -15.95274 156.49008 -15.95274 C 149.58644 -15.95274 143.99008 -21.5491 143.99008 -28.45274 C 143.99008 -35.35638 149.58644 -40.95274 156.49008 -40.95274 C 163.39372 -40.95274 168.99008 -35.35638 168.99008 -28.45274 Z M 156.49008 -28.45274" fill="none"></path><g transform="translate(152.55884,-31.8694)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(82.4844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="82.4844" xlink:href="#g1-71" y="-59.247822"></use></g></g></g></g><path d="M 49.48865 -71.13185 C 49.48865 -64.22821 43.89229 -58.63185 36.98865 -58.63185 C 30.085 -58.63185 24.48865 -64.22821 24.48865 -71.13185 C 24.48865 -78.03549 30.085 -83.63185 36.98865 -83.63185 C 43.89229 -83.63185 49.48865 -78.03549 49.48865 -71.13185 Z M 36.98865 -71.13185" fill="none"></path><g transform="translate(34.13101,-73.28462)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(82.4844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="82.4844" xlink:href="#g1-120" y="-59.247822"></use></g></g></g></g><path d="M 106.39413 -71.13185 C 106.39413 -64.22821 100.79778 -58.63185 93.89413 -58.63185 C 86.9905 -58.63185 81.39413 -64.22821 81.39413 -71.13185 C 81.39413 -78.03549 86.9905 -83.63185 93.89413 -83.63185 C 100.79778 -83.63185 106.39413 -78.03549 106.39413 -71.13185 Z M 93.89413 -71.13185" fill="none"></path><g transform="translate(91.26334,-72.31241)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(82.4844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="82.4844" xlink:href="#g1-121" y="-59.247822"></use></g></g></g></g><path d="M 146.2278 -71.13185 C 146.2278 -64.22821 140.63144 -58.63185 133.7278 -58.63185 C 126.82416 -58.63185 121.2278 -64.22821 121.2278 -71.13185 C 121.2278 -78.03549 126.82416 -83.63185 133.7278 -83.63185 C 140.63144 -83.63185 146.2278 -78.03549 146.2278 -71.13185 Z M 133.7278 -71.13185" fill="none"></path><g transform="translate(131.18265,-73.28462)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(82.4844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="82.4844" xlink:href="#g1-122" y="-59.247822"></use></g></g></g></g><path d="M 203.13329 -71.13185 C 203.13329 -64.22821 197.53693 -58.63185 190.63329 -58.63185 C 183.72964 -58.63185 178.13329 -64.22821 178.13329 -71.13185 C 178.13329 -78.03549 183.72964 -83.63185 190.63329 -83.63185 C 197.53693 -83.63185 203.13329 -78.03549 203.13329 -71.13185 Z M 190.63329 -71.13185" fill="none"></path><g transform="translate(186.91916,-73.28462)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(82.4844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="82.4844" xlink:href="#g1-119" y="-59.247822"></use></g></g></g></g><path d="M -28.45274 -28.45274 L 24.40657 -28.45274" fill="none"></path><g transform="translate(22.30711,-28.45274)"><g stroke-dasharray="none" stroke-dashoffset="0.0"> <g stroke-linejoin="round"> <path d=" M 4.84563 0.0 L 0.96873 1.46368 L 2.24945 0.0 L 0.96873 -1.46368 Z  "></path> </g> </g></g><g transform="translate(-33.635,-26.04276)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(82.4844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="82.4844" xlink:href="#g0-47" y="-59.247822"></use><use x="88.023625" xlink:href="#g0-81" y="-59.247822"></use><use x="93.004945" xlink:href="#g0-109" y="-59.247822"></use><use x="98.544171" xlink:href="#g0-35" y="-59.247822"></use><use x="104.083412" xlink:href="#g0-72" y="-59.247822"></use><use x="106.853024" xlink:href="#g0-50" y="-59.247822"></use><use x="114.593985" xlink:href="#g0-96" y="-59.247822"></use><use x="118.499338" xlink:href="#g0-81" y="-59.247822"></use><use x="123.480658" xlink:href="#g0-105" y="-59.247822"></use><use x="127.356124" xlink:href="#g0-28" y="-59.247822"></use><use x="132.337444" xlink:href="#g0-105" y="-59.247822"></use><use x="136.212911" xlink:href="#g0-66" y="-59.247822"></use><use x="138.982523" xlink:href="#g0-81" y="-59.247822"></use><use x="143.963843" xlink:href="#g0-77" y="-59.247822"></use></g></g></g></g><path d="M -94.4092 -9.05096 L -104.0529 -18.69467" fill="none"></path><path d="M -122.86194 -37.50371 L -132.50565 -47.14742" fill="none"></path><path d="M -104.76001 -37.50371 L -95.1163 -47.14742" fill="none"></path><path d="M -76.30727 -9.05096 L -66.66356 -18.69467" fill="none"></path><path d="M -94.4092 -65.95645 L -104.0529 -75.60016" fill="none"></path><path d="M -76.30727 -65.95645 L -66.66356 -75.60016" fill="none"></path><path d="M 103.16118 -7.0998 L 82.61366 -20.79828" fill="none"></path><path d="M 124.46077 -7.0998 L 145.00827 -20.79828" fill="none"></path><path d="M 63.13615 -38.44727 L 45.609 -60.3565" fill="none"></path><path d="M 77.15529 -39.74669 L 87.40013 -58.95558" fill="none"></path><path d="M 150.46664 -39.74669 L 140.2218 -58.95558" fill="none"></path><path d="M 164.48578 -38.44727 L 182.01294 -60.3565" fill="none"></path></g></g></g></g></g></svg></div>
<div class="arithmatex">\[\begin{align}
    \hat{c_i} &amp;= 2 + \operatorname{rank}_2(X) - \operatorname{rank}_1(X) + \operatorname{rank}_2(P) - \operatorname{rank}_1(P) + \operatorname{rank}_2(G) - \operatorname{rank}_1(G) \\
    &amp;= 2 + \operatorname{rank}_2(P) + \operatorname{rank}_2(G) - \operatorname{rank}_1(X) - \operatorname{rank}_1(P) \ (\operatorname{rank}_2(X) = \operatorname{rank}_1(G)) \\
    &amp;\leqslant 2 + 2\operatorname{rank}_2(X) - 2 - \operatorname{rank}_1(X) - \operatorname{rank}_1(P) \ (\text{by the lemma}) \\
    &amp;\leqslant 2(\operatorname{rank}_2(X) - \operatorname{rank}_1(X)) \ (\operatorname{rank}_1(P) \geqslant \operatorname{rank}_1(X))
\end{align}\]</div>
</div>
<div class="tabbed-block">
<p></p><div style="text-align: center; zoom: 1.5;"><!-- This file was generated by dvisvgm 2.13.3 --><svg height="110.543701pt" version="1.1" viewbox="-72.000004 -72.000008 365.661699 110.543701" width="365.661699pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M7.571606-6.924035C7.571606-6.953923 7.551681-7.023661 7.462017-7.023661C7.43213-7.023661 7.422167-7.013699 7.312578-6.90411L6.615193-6.136986C6.525529-6.276463 6.067248-7.023661 4.961395-7.023661C2.739726-7.023661 .498132-4.821918 .498132-2.510585C.498132-.926526 1.603985 .219178 3.217933 .219178C3.656289 .219178 4.104608 .129514 4.463263-.019925C4.961395-.219178 5.150685-.428394 5.330012-.627646C5.419676-.37858 5.678705-.009963 5.778331-.009963C5.828144-.009963 5.84807-.039851 5.84807-.049813C5.867995-.069738 5.967621-.448319 6.017435-.657534L6.206725-1.424658C6.246575-1.594022 6.296389-1.763387 6.336239-1.932752C6.445828-2.381071 6.455791-2.400996 7.023661-2.410959C7.073474-2.410959 7.183064-2.420922 7.183064-2.610212C7.183064-2.67995 7.13325-2.719801 7.053549-2.719801C6.824408-2.719801 6.236613-2.689913 6.007472-2.689913C5.69863-2.689913 4.921544-2.719801 4.612702-2.719801C4.523039-2.719801 4.403487-2.719801 4.403487-2.520548C4.403487-2.410959 4.483188-2.410959 4.702366-2.410959C4.712329-2.410959 5.001245-2.410959 5.230386-2.391034C5.489415-2.361146 5.539228-2.331258 5.539228-2.201743C5.539228-2.11208 5.429639-1.663761 5.330012-1.295143C5.051059-.199253 3.755915-.089664 3.407223-.089664C2.450809-.089664 1.404732-.657534 1.404732-2.181818C1.404732-2.49066 1.504359-4.134496 2.550436-5.429639C3.088418-6.107098 4.054795-6.714819 5.041096-6.714819C6.057285-6.714819 6.645081-5.947696 6.645081-4.79203C6.645081-4.393524 6.615193-4.383562 6.615193-4.283935S6.724782-4.184309 6.764633-4.184309C6.894147-4.184309 6.894147-4.204234 6.94396-4.383562L7.571606-6.924035Z" id="g1-71"></path><path d="M3.01868-3.148194H4.712329C6.127024-3.148194 7.511831-4.184309 7.511831-5.300125C7.511831-6.067248 6.854296-6.804483 5.549191-6.804483H2.321295C2.132005-6.804483 2.022416-6.804483 2.022416-6.615193C2.022416-6.495641 2.11208-6.495641 2.311333-6.495641C2.440847-6.495641 2.620174-6.485679 2.739726-6.475716C2.899128-6.455791 2.958904-6.425903 2.958904-6.316314C2.958904-6.276463 2.948941-6.246575 2.919054-6.127024L1.58406-.777086C1.484433-.388543 1.464508-.308842 .67746-.308842C.508095-.308842 .398506-.308842 .398506-.119552C.398506 0 .518057 0 .547945 0C.826899 0 1.534247-.029888 1.8132-.029888C2.022416-.029888 2.241594-.019925 2.450809-.019925C2.669988-.019925 2.889166 0 3.098381 0C3.16812 0 3.297634 0 3.297634-.199253C3.297634-.308842 3.20797-.308842 3.01868-.308842C2.650062-.308842 2.371108-.308842 2.371108-.488169C2.371108-.547945 2.391034-.597758 2.400996-.657534L3.01868-3.148194ZM3.73599-6.117061C3.825654-6.465753 3.845579-6.495641 4.273973-6.495641H5.230386C6.057285-6.495641 6.585305-6.22665 6.585305-5.539228C6.585305-5.150685 6.386052-4.293898 5.997509-3.935243C5.499377-3.486924 4.901619-3.407223 4.463263-3.407223H3.058531L3.73599-6.117061Z" id="g1-80"></path><path d="M4.83188-4.094645L3.995019-6.07721C3.965131-6.156912 3.945205-6.196762 3.945205-6.206725C3.945205-6.266501 4.11457-6.455791 4.533001-6.495641C4.632628-6.505604 4.732254-6.515567 4.732254-6.684932C4.732254-6.804483 4.612702-6.804483 4.582814-6.804483C4.174346-6.804483 3.745953-6.774595 3.327522-6.774595C3.078456-6.774595 2.460772-6.804483 2.211706-6.804483C2.15193-6.804483 2.032379-6.804483 2.032379-6.60523C2.032379-6.495641 2.132005-6.495641 2.261519-6.495641C2.859278-6.495641 2.919054-6.396015 3.008717-6.176837L4.184309-3.39726L2.082192-1.135741L1.952677-1.026152C1.464508-.498132 .996264-.33873 .488169-.308842C.358655-.298879 .268991-.298879 .268991-.109589C.268991-.099626 .268991 0 .398506 0C.697385 0 1.026152-.029888 1.334994-.029888C1.703611-.029888 2.092154 0 2.450809 0C2.510585 0 2.630137 0 2.630137-.199253C2.630137-.298879 2.530511-.308842 2.510585-.308842C2.420922-.318804 2.11208-.33873 2.11208-.617684C2.11208-.777086 2.261519-.936488 2.381071-1.066002L3.39726-2.141968L4.293898-3.118306L5.300125-.737235C5.339975-.627646 5.349938-.617684 5.349938-.597758C5.349938-.518057 5.160648-.348692 4.772105-.308842C4.662516-.298879 4.572852-.288917 4.572852-.119552C4.572852 0 4.682441 0 4.722291 0C5.001245 0 5.69863-.029888 5.977584-.029888C6.22665-.029888 6.834371 0 7.083437 0C7.153176 0 7.272727 0 7.272727-.18929C7.272727-.308842 7.173101-.308842 7.0934-.308842C6.425903-.318804 6.405978-.348692 6.236613-.747198C5.84807-1.673724 5.180573-3.227895 4.951432-3.825654C5.628892-4.523039 6.674969-5.708593 6.993773-5.987547C7.28269-6.22665 7.66127-6.465753 8.259029-6.495641C8.388543-6.505604 8.478207-6.505604 8.478207-6.694894C8.478207-6.704857 8.478207-6.804483 8.348692-6.804483C8.049813-6.804483 7.721046-6.774595 7.412204-6.774595C7.043587-6.774595 6.665006-6.804483 6.306351-6.804483C6.246575-6.804483 6.117061-6.804483 6.117061-6.60523C6.117061-6.535492 6.166874-6.505604 6.236613-6.495641C6.326276-6.485679 6.635118-6.465753 6.635118-6.1868C6.635118-6.047323 6.525529-5.917808 6.445828-5.828144L4.83188-4.094645Z" id="g1-88"></path><path d="M4.60274-3.377335C4.652553-3.596513 4.752179-3.965131 4.752179-4.024907C4.752179-4.204234 4.612702-4.293898 4.463263-4.293898C4.343711-4.293898 4.164384-4.214197 4.094645-4.014944C4.064757-3.945205 3.596513-2.042341 3.526775-1.783313C3.457036-1.484433 3.437111-1.305106 3.437111-1.125778C3.437111-1.016189 3.437111-.996264 3.447073-.946451C3.217933-.418431 2.919054-.109589 2.530511-.109589C1.733499-.109589 1.733499-.846824 1.733499-1.016189C1.733499-1.334994 1.783313-1.723537 2.251557-2.948941C2.361146-3.247821 2.420922-3.387298 2.420922-3.58655C2.420922-4.034869 2.092154-4.403487 1.603985-4.403487C.657534-4.403487 .288917-2.958904 .288917-2.86924C.288917-2.769614 .388543-2.769614 .408468-2.769614C.508095-2.769614 .518057-2.789539 .56787-2.948941C.836862-3.875467 1.225405-4.184309 1.574097-4.184309C1.663761-4.184309 1.823163-4.174346 1.823163-3.855542C1.823163-3.606476 1.713574-3.327522 1.643836-3.158157C1.205479-1.982565 1.085928-1.524284 1.085928-1.145704C1.085928-.239103 1.753425 .109589 2.500623 .109589C2.669988 .109589 3.138232 .109589 3.536737-.587796C3.795766 .049813 4.483188 .109589 4.782067 .109589C5.529265 .109589 5.967621-.518057 6.22665-1.115816C6.56538-1.892902 6.884184-3.227895 6.884184-3.706102C6.884184-4.254047 6.615193-4.403487 6.445828-4.403487C6.196762-4.403487 5.947696-4.144458 5.947696-3.92528C5.947696-3.795766 6.007472-3.73599 6.097136-3.656289C6.206725-3.5467 6.455791-3.287671 6.455791-2.809465C6.455791-2.470735 6.166874-1.494396 5.907846-.986301C5.648817-.458281 5.300125-.109589 4.811955-.109589C4.343711-.109589 4.07472-.408468 4.07472-.976339C4.07472-1.255293 4.144458-1.564134 4.184309-1.703611L4.60274-3.377335Z" id="g1-119"></path><path d="M3.327522-3.008717C3.387298-3.267746 3.616438-4.184309 4.313823-4.184309C4.363636-4.184309 4.60274-4.184309 4.811955-4.054795C4.533001-4.004981 4.333748-3.755915 4.333748-3.516812C4.333748-3.35741 4.443337-3.16812 4.712329-3.16812C4.931507-3.16812 5.250311-3.347447 5.250311-3.745953C5.250311-4.26401 4.662516-4.403487 4.323786-4.403487C3.745953-4.403487 3.39726-3.875467 3.277709-3.646326C3.028643-4.303861 2.49066-4.403487 2.201743-4.403487C1.165629-4.403487 .597758-3.118306 .597758-2.86924C.597758-2.769614 .697385-2.769614 .71731-2.769614C.797011-2.769614 .826899-2.789539 .846824-2.879203C1.185554-3.935243 1.843088-4.184309 2.181818-4.184309C2.371108-4.184309 2.719801-4.094645 2.719801-3.516812C2.719801-3.20797 2.550436-2.540473 2.181818-1.145704C2.022416-.52802 1.673724-.109589 1.235367-.109589C1.175592-.109589 .946451-.109589 .737235-.239103C.986301-.288917 1.205479-.498132 1.205479-.777086C1.205479-1.046077 .986301-1.125778 .836862-1.125778C.537983-1.125778 .288917-.86675 .288917-.547945C.288917-.089664 .787049 .109589 1.225405 .109589C1.882939 .109589 2.241594-.587796 2.271482-.647572C2.391034-.278954 2.749689 .109589 3.347447 .109589C4.373599 .109589 4.941469-1.175592 4.941469-1.424658C4.941469-1.524284 4.851806-1.524284 4.821918-1.524284C4.732254-1.524284 4.712329-1.484433 4.692403-1.414695C4.363636-.348692 3.686177-.109589 3.367372-.109589C2.978829-.109589 2.819427-.428394 2.819427-.767123C2.819427-.986301 2.879203-1.205479 2.988792-1.643836L3.327522-3.008717Z" id="g1-120"></path><path d="M4.841843-3.795766C4.881694-3.935243 4.881694-3.955168 4.881694-4.024907C4.881694-4.204234 4.742217-4.293898 4.592777-4.293898C4.493151-4.293898 4.333748-4.234122 4.244085-4.084682C4.224159-4.034869 4.144458-3.726027 4.104608-3.5467C4.034869-3.287671 3.965131-3.01868 3.905355-2.749689L3.457036-.956413C3.417186-.806974 2.988792-.109589 2.331258-.109589C1.823163-.109589 1.713574-.547945 1.713574-.916563C1.713574-1.374844 1.882939-1.992528 2.221669-2.86924C2.381071-3.277709 2.420922-3.387298 2.420922-3.58655C2.420922-4.034869 2.102117-4.403487 1.603985-4.403487C.657534-4.403487 .288917-2.958904 .288917-2.86924C.288917-2.769614 .388543-2.769614 .408468-2.769614C.508095-2.769614 .518057-2.789539 .56787-2.948941C.836862-3.88543 1.235367-4.184309 1.574097-4.184309C1.653798-4.184309 1.823163-4.184309 1.823163-3.865504C1.823163-3.616438 1.723537-3.35741 1.653798-3.16812C1.255293-2.11208 1.075965-1.544209 1.075965-1.075965C1.075965-.18929 1.703611 .109589 2.291407 .109589C2.67995 .109589 3.01868-.059776 3.297634-.33873C3.16812 .179328 3.048568 .667497 2.650062 1.195517C2.391034 1.534247 2.012453 1.823163 1.554172 1.823163C1.414695 1.823163 .966376 1.793275 .797011 1.404732C.956413 1.404732 1.085928 1.404732 1.225405 1.285181C1.325031 1.195517 1.424658 1.066002 1.424658 .876712C1.424658 .56787 1.155666 .52802 1.05604 .52802C.826899 .52802 .498132 .687422 .498132 1.175592C.498132 1.673724 .936488 2.042341 1.554172 2.042341C2.580324 2.042341 3.606476 1.135741 3.88543 .009963L4.841843-3.795766Z" id="g1-121"></path><path d="M1.325031-.826899C1.863014-1.404732 2.15193-1.653798 2.510585-1.96264C2.510585-1.972603 3.128269-2.500623 3.486924-2.859278C4.433375-3.785803 4.652553-4.26401 4.652553-4.303861C4.652553-4.403487 4.562889-4.403487 4.542964-4.403487C4.473225-4.403487 4.443337-4.383562 4.393524-4.293898C4.094645-3.815691 3.88543-3.656289 3.646326-3.656289S3.287671-3.805729 3.138232-3.975093C2.948941-4.204234 2.779577-4.403487 2.450809-4.403487C1.703611-4.403487 1.24533-3.476961 1.24533-3.267746C1.24533-3.217933 1.275218-3.158157 1.364882-3.158157S1.474471-3.20797 1.494396-3.267746C1.683686-3.726027 2.261519-3.73599 2.34122-3.73599C2.550436-3.73599 2.739726-3.666252 2.968867-3.58655C3.367372-3.437111 3.476961-3.437111 3.73599-3.437111C3.377335-3.008717 2.540473-2.291407 2.351183-2.132005L1.454545-1.295143C.777086-.627646 .428394-.059776 .428394 .009963C.428394 .109589 .52802 .109589 .547945 .109589C.627646 .109589 .647572 .089664 .707347-.019925C.936488-.368618 1.235367-.637609 1.554172-.637609C1.783313-.637609 1.882939-.547945 2.132005-.259029C2.30137-.049813 2.480697 .109589 2.769614 .109589C3.755915 .109589 4.333748-1.155666 4.333748-1.424658C4.333748-1.474471 4.293898-1.524284 4.214197-1.524284C4.124533-1.524284 4.104608-1.464508 4.07472-1.39477C3.845579-.747198 3.20797-.557908 2.879203-.557908C2.67995-.557908 2.500623-.617684 2.291407-.687422C1.952677-.816936 1.803238-.856787 1.594022-.856787C1.574097-.856787 1.414695-.856787 1.325031-.826899Z" id="g1-122"></path><path d="M4.811955-.886675V-1.444583H4.562889V-.886675C4.562889-.308842 4.313823-.249066 4.204234-.249066C3.875467-.249066 3.835616-.697385 3.835616-.747198V-2.739726C3.835616-3.158157 3.835616-3.5467 3.476961-3.915318C3.088418-4.303861 2.590286-4.463263 2.11208-4.463263C1.295143-4.463263 .607721-3.995019 .607721-3.337484C.607721-3.038605 .806974-2.86924 1.066002-2.86924C1.344956-2.86924 1.524284-3.068493 1.524284-3.327522C1.524284-3.447073 1.474471-3.775841 1.016189-3.785803C1.285181-4.134496 1.77335-4.244085 2.092154-4.244085C2.580324-4.244085 3.148194-3.855542 3.148194-2.968867V-2.600249C2.6401-2.570361 1.942715-2.540473 1.315068-2.241594C.56787-1.902864 .318804-1.384807 .318804-.946451C.318804-.139477 1.285181 .109589 1.912827 .109589C2.570361 .109589 3.028643-.288917 3.217933-.757161C3.257783-.358655 3.526775 .059776 3.995019 .059776C4.204234 .059776 4.811955-.079701 4.811955-.886675ZM3.148194-1.39477C3.148194-.448319 2.430884-.109589 1.982565-.109589C1.494396-.109589 1.085928-.458281 1.085928-.956413C1.085928-1.504359 1.504359-2.331258 3.148194-2.391034V-1.39477Z" id="g0-28"></path><path d="M5.190535-2.15193C5.190535-3.417186 4.214197-4.403487 3.078456-4.403487C2.30137-4.403487 1.872976-3.935243 1.713574-3.755915V-6.914072L.278954-6.804483V-6.495641C.976339-6.495641 1.05604-6.425903 1.05604-5.937733V0H1.305106L1.663761-.617684C1.8132-.388543 2.231631 .109589 2.968867 .109589C4.154421 .109589 5.190535-.86675 5.190535-2.15193ZM4.363636-2.161893C4.363636-1.793275 4.343711-1.195517 4.054795-.747198C3.845579-.438356 3.466999-.109589 2.929016-.109589C2.480697-.109589 2.122042-.348692 1.882939-.71731C1.743462-.926526 1.743462-.956413 1.743462-1.135741V-3.188045C1.743462-3.377335 1.743462-3.387298 1.853051-3.5467C2.241594-4.104608 2.789539-4.184309 3.028643-4.184309C3.476961-4.184309 3.835616-3.92528 4.07472-3.5467C4.333748-3.138232 4.363636-2.570361 4.363636-2.161893Z" id="g0-35"></path><path d="M5.250311 0V-.308842C4.552927-.308842 4.473225-.37858 4.473225-.86675V-6.914072L3.038605-6.804483V-6.495641C3.73599-6.495641 3.815691-6.425903 3.815691-5.937733V-3.785803C3.526775-4.144458 3.098381-4.403487 2.560399-4.403487C1.384807-4.403487 .33873-3.427148 .33873-2.141968C.33873-.876712 1.315068 .109589 2.450809 .109589C3.088418 .109589 3.536737-.229141 3.785803-.547945V.109589L5.250311 0ZM3.785803-1.175592C3.785803-.996264 3.785803-.976339 3.676214-.806974C3.377335-.328767 2.929016-.109589 2.500623-.109589C2.052304-.109589 1.693649-.368618 1.454545-.747198C1.195517-1.155666 1.165629-1.723537 1.165629-2.132005C1.165629-2.500623 1.185554-3.098381 1.474471-3.5467C1.683686-3.855542 2.062267-4.184309 2.600249-4.184309C2.948941-4.184309 3.367372-4.034869 3.676214-3.58655C3.785803-3.417186 3.785803-3.39726 3.785803-3.217933V-1.175592Z" id="g0-47"></path><path d="M4.134496-1.185554C4.134496-1.285181 4.054795-1.305106 4.004981-1.305106C3.915318-1.305106 3.895392-1.24533 3.875467-1.165629C3.526775-.139477 2.630137-.139477 2.530511-.139477C2.032379-.139477 1.633873-.438356 1.404732-.806974C1.105853-1.285181 1.105853-1.942715 1.105853-2.30137H3.88543C4.104608-2.30137 4.134496-2.30137 4.134496-2.510585C4.134496-3.496887 3.596513-4.463263 2.351183-4.463263C1.195517-4.463263 .278954-3.437111 .278954-2.191781C.278954-.856787 1.325031 .109589 2.470735 .109589C3.686177 .109589 4.134496-.996264 4.134496-1.185554ZM3.476961-2.510585H1.115816C1.175592-3.995019 2.012453-4.244085 2.351183-4.244085C3.377335-4.244085 3.476961-2.899128 3.476961-2.510585Z" id="g0-50"></path><path d="M2.460772 0V-.308842C1.803238-.308842 1.763387-.358655 1.763387-.747198V-4.403487L.368618-4.293898V-3.985056C1.016189-3.985056 1.105853-3.92528 1.105853-3.437111V-.757161C1.105853-.308842 .996264-.308842 .328767-.308842V0L1.424658-.029888C1.77335-.029888 2.122042-.009963 2.460772 0ZM1.912827-6.017435C1.912827-6.286426 1.683686-6.545455 1.384807-6.545455C1.046077-6.545455 .846824-6.266501 .846824-6.017435C.846824-5.748443 1.075965-5.489415 1.374844-5.489415C1.713574-5.489415 1.912827-5.768369 1.912827-6.017435Z" id="g0-66"></path><path d="M2.540473 0V-.308842C1.872976-.308842 1.763387-.308842 1.763387-.757161V-6.914072L.328767-6.804483V-6.495641C1.026152-6.495641 1.105853-6.425903 1.105853-5.937733V-.757161C1.105853-.308842 .996264-.308842 .328767-.308842V0L1.43462-.029888L2.540473 0Z" id="g0-72"></path><path d="M5.330012 0V-.308842C4.811955-.308842 4.562889-.308842 4.552927-.607721V-2.510585C4.552927-3.367372 4.552927-3.676214 4.244085-4.034869C4.104608-4.204234 3.775841-4.403487 3.198007-4.403487C2.470735-4.403487 2.002491-3.975093 1.723537-3.35741V-4.403487L.318804-4.293898V-3.985056C1.016189-3.985056 1.09589-3.915318 1.09589-3.427148V-.757161C1.09589-.308842 .986301-.308842 .318804-.308842V0L1.444583-.029888L2.560399 0V-.308842C1.892902-.308842 1.783313-.308842 1.783313-.757161V-2.590286C1.783313-3.626401 2.49066-4.184309 3.128269-4.184309C3.755915-4.184309 3.865504-3.646326 3.865504-3.078456V-.757161C3.865504-.308842 3.755915-.308842 3.088418-.308842V0L4.214197-.029888L5.330012 0Z" id="g0-77"></path><path d="M4.692403-2.132005C4.692403-3.407223 3.696139-4.463263 2.49066-4.463263C1.24533-4.463263 .278954-3.377335 .278954-2.132005C.278954-.846824 1.315068 .109589 2.480697 .109589C3.686177 .109589 4.692403-.86675 4.692403-2.132005ZM3.865504-2.211706C3.865504-1.853051 3.865504-1.315068 3.646326-.876712C3.427148-.428394 2.988792-.139477 2.49066-.139477C2.062267-.139477 1.62391-.348692 1.354919-.806974C1.105853-1.24533 1.105853-1.853051 1.105853-2.211706C1.105853-2.600249 1.105853-3.138232 1.344956-3.576588C1.613948-4.034869 2.082192-4.244085 2.480697-4.244085C2.919054-4.244085 3.347447-4.024907 3.606476-3.596513S3.865504-2.590286 3.865504-2.211706Z" id="g0-81"></path><path d="M3.626401-3.795766C3.626401-4.11457 3.317559-4.403487 2.889166-4.403487C2.161893-4.403487 1.803238-3.73599 1.663761-3.307597V-4.403487L.278954-4.293898V-3.985056C.976339-3.985056 1.05604-3.915318 1.05604-3.427148V-.757161C1.05604-.308842 .946451-.308842 .278954-.308842V0L1.414695-.029888C1.8132-.029888 2.281445-.029888 2.67995 0V-.308842H2.470735C1.733499-.308842 1.713574-.418431 1.713574-.777086V-2.311333C1.713574-3.297634 2.132005-4.184309 2.889166-4.184309C2.958904-4.184309 2.978829-4.184309 2.998755-4.174346C2.968867-4.164384 2.769614-4.044832 2.769614-3.785803C2.769614-3.506849 2.978829-3.35741 3.198007-3.35741C3.377335-3.35741 3.626401-3.476961 3.626401-3.795766Z" id="g0-96"></path><path d="M3.307597-1.235367V-1.803238H3.058531V-1.255293C3.058531-.518057 2.759651-.139477 2.391034-.139477C1.723537-.139477 1.723537-1.046077 1.723537-1.215442V-3.985056H3.148194V-4.293898H1.723537V-6.127024H1.474471C1.464508-5.310087 1.165629-4.244085 .18929-4.204234V-3.985056H1.036115V-1.235367C1.036115-.009963 1.96264 .109589 2.321295 .109589C3.028643 .109589 3.307597-.597758 3.307597-1.235367Z" id="g0-105"></path><path d="M5.330012 0V-.308842C4.632628-.308842 4.552927-.37858 4.552927-.86675V-4.403487L3.088418-4.293898V-3.985056C3.785803-3.985056 3.865504-3.915318 3.865504-3.427148V-1.653798C3.865504-.787049 3.387298-.109589 2.660025-.109589C1.823163-.109589 1.783313-.577833 1.783313-1.09589V-4.403487L.318804-4.293898V-3.985056C1.09589-3.985056 1.09589-3.955168 1.09589-3.068493V-1.574097C1.09589-.797011 1.09589 .109589 2.610212 .109589C3.16812 .109589 3.606476-.169365 3.895392-.787049V.109589L5.330012 0Z" id="g0-109"></path></defs><g id="page1"><g stroke-miterlimit="10" transform="translate(110.830844,-59.247822)scale(0.996264,-0.996264)"><g fill="#000" stroke="#000"><g stroke-width="0.4"><g stroke-width="0.7"><path d="M -72.85823 0.0 C -72.85823 6.90364 -78.45459 12.5 -85.35823 12.5 C -92.26187 12.5 -97.85823 6.90364 -97.85823 0.0 C -97.85823 -6.90364 -92.26187 -12.5 -85.35823 -12.5 C -78.45459 -12.5 -72.85823 -6.90364 -72.85823 0.0 Z M -85.35823 0.0" fill="none"></path><g transform="translate(-89.28947,-3.41666)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(110.830844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="110.830844" xlink:href="#g1-71" y="-59.247822"></use></g></g></g></g><path d="M -101.31097 -28.45274 C -101.31097 -21.5491 -106.90733 -15.95274 -113.81097 -15.95274 C -120.71461 -15.95274 -126.31097 -21.5491 -126.31097 -28.45274 C -126.31097 -35.35638 -120.71461 -40.95274 -113.81097 -40.95274 C -106.90733 -40.95274 -101.31097 -35.35638 -101.31097 -28.45274 Z M -113.81097 -28.45274" fill="none"></path><g transform="translate(-117.71548,-31.8694)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(110.830844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="110.830844" xlink:href="#g1-80" y="-59.247822"></use></g></g></g></g><path d="M -129.76372 -56.90549 C -129.76372 -50.00185 -135.36008 -44.40549 -142.26372 -44.40549 C -149.16736 -44.40549 -154.76372 -50.00185 -154.76372 -56.90549 C -154.76372 -63.80913 -149.16736 -69.40549 -142.26372 -69.40549 C -135.36008 -69.40549 -129.76372 -63.80913 -129.76372 -56.90549 Z M -142.26372 -56.90549" fill="none"></path><g transform="translate(-146.79843,-60.32214)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(110.830844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="110.830844" xlink:href="#g1-88" y="-59.247822"></use></g></g></g></g><path d="M -158.21646 -85.35823 C -158.21646 -78.45459 -163.81282 -72.85823 -170.71646 -72.85823 C -177.6201 -72.85823 -183.21646 -78.45459 -183.21646 -85.35823 C -183.21646 -92.26187 -177.6201 -97.85823 -170.71646 -97.85823 C -163.81282 -97.85823 -158.21646 -92.26187 -158.21646 -85.35823 Z M -170.71646 -85.35823" fill="none"></path><g transform="translate(-173.5741,-87.511)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(110.830844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="110.830844" xlink:href="#g1-120" y="-59.247822"></use></g></g></g></g><path d="M -101.31097 -85.35823 C -101.31097 -78.45459 -106.90733 -72.85823 -113.81097 -72.85823 C -120.71461 -72.85823 -126.31097 -78.45459 -126.31097 -85.35823 C -126.31097 -92.26187 -120.71461 -97.85823 -113.81097 -97.85823 C -106.90733 -97.85823 -101.31097 -92.26187 -101.31097 -85.35823 Z M -113.81097 -85.35823" fill="none"></path><g transform="translate(-116.44177,-86.53879)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(110.830844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="110.830844" xlink:href="#g1-121" y="-59.247822"></use></g></g></g></g><path d="M -72.85823 -56.90549 C -72.85823 -50.00185 -78.45459 -44.40549 -85.35823 -44.40549 C -92.26187 -44.40549 -97.85823 -50.00185 -97.85823 -56.90549 C -97.85823 -63.80913 -92.26187 -69.40549 -85.35823 -69.40549 C -78.45459 -69.40549 -72.85823 -63.80913 -72.85823 -56.90549 Z M -85.35823 -56.90549" fill="none"></path><g transform="translate(-87.90338,-59.05826)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(110.830844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="110.830844" xlink:href="#g1-122" y="-59.247822"></use></g></g></g></g><path d="M -44.40549 -28.45274 C -44.40549 -21.5491 -50.00185 -15.95274 -56.90549 -15.95274 C -63.80913 -15.95274 -69.40549 -21.5491 -69.40549 -28.45274 C -69.40549 -35.35638 -63.80913 -40.95274 -56.90549 -40.95274 C -50.00185 -40.95274 -44.40549 -35.35638 -44.40549 -28.45274 Z M -56.90549 -28.45274" fill="none"></path><g transform="translate(-60.61961,-30.60551)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(110.830844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="110.830844" xlink:href="#g1-119" y="-59.247822"></use></g></g></g></g><path d="M 97.85823 0.0 C 97.85823 6.90364 92.26187 12.5 85.35823 12.5 C 78.45459 12.5 72.85823 6.90364 72.85823 0.0 C 72.85823 -6.90364 78.45459 -12.5 85.35823 -12.5 C 92.26187 -12.5 97.85823 -6.90364 97.85823 0.0 Z M 85.35823 0.0" fill="none"></path><g transform="translate(80.82352,-3.41666)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(110.830844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="110.830844" xlink:href="#g1-88" y="-59.247822"></use></g></g></g></g><path d="M 126.31097 -28.45274 C 126.31097 -21.5491 120.71461 -15.95274 113.81097 -15.95274 C 106.90733 -15.95274 101.31097 -21.5491 101.31097 -28.45274 C 101.31097 -35.35638 106.90733 -40.95274 113.81097 -40.95274 C 120.71461 -40.95274 126.31097 -35.35638 126.31097 -28.45274 Z M 113.81097 -28.45274" fill="none"></path><g transform="translate(109.90646,-31.8694)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(110.830844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="110.830844" xlink:href="#g1-80" y="-59.247822"></use></g></g></g></g><path d="M 154.76372 -56.90549 C 154.76372 -50.00185 149.16736 -44.40549 142.26372 -44.40549 C 135.36008 -44.40549 129.76372 -50.00185 129.76372 -56.90549 C 129.76372 -63.80913 135.36008 -69.40549 142.26372 -69.40549 C 149.16736 -69.40549 154.76372 -63.80913 154.76372 -56.90549 Z M 142.26372 -56.90549" fill="none"></path><g transform="translate(138.33247,-60.32214)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(110.830844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="110.830844" xlink:href="#g1-71" y="-59.247822"></use></g></g></g></g><path d="M 69.40549 -28.45274 C 69.40549 -21.5491 63.80913 -15.95274 56.90549 -15.95274 C 50.00185 -15.95274 44.40549 -21.5491 44.40549 -28.45274 C 44.40549 -35.35638 50.00185 -40.95274 56.90549 -40.95274 C 63.80913 -40.95274 69.40549 -35.35638 69.40549 -28.45274 Z M 56.90549 -28.45274" fill="none"></path><g transform="translate(54.04785,-30.60551)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(110.830844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="110.830844" xlink:href="#g1-120" y="-59.247822"></use></g></g></g></g><path d="M 97.85823 -56.90549 C 97.85823 -50.00185 92.26187 -44.40549 85.35823 -44.40549 C 78.45459 -44.40549 72.85823 -50.00185 72.85823 -56.90549 C 72.85823 -63.80913 78.45459 -69.40549 85.35823 -69.40549 C 92.26187 -69.40549 97.85823 -63.80913 97.85823 -56.90549 Z M 85.35823 -56.90549" fill="none"></path><g transform="translate(82.72743,-58.08604)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(110.830844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="110.830844" xlink:href="#g1-121" y="-59.247822"></use></g></g></g></g><path d="M 126.31097 -85.35823 C 126.31097 -78.45459 120.71461 -72.85823 113.81097 -72.85823 C 106.90733 -72.85823 101.31097 -78.45459 101.31097 -85.35823 C 101.31097 -92.26187 106.90733 -97.85823 113.81097 -97.85823 C 120.71461 -97.85823 126.31097 -92.26187 126.31097 -85.35823 Z M 113.81097 -85.35823" fill="none"></path><g transform="translate(111.26582,-87.511)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(110.830844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="110.830844" xlink:href="#g1-122" y="-59.247822"></use></g></g></g></g><path d="M 183.21646 -85.35823 C 183.21646 -78.45459 177.6201 -72.85823 170.71646 -72.85823 C 163.81282 -72.85823 158.21646 -78.45459 158.21646 -85.35823 C 158.21646 -92.26187 163.81282 -97.85823 170.71646 -97.85823 C 177.6201 -97.85823 183.21646 -92.26187 183.21646 -85.35823 Z M 170.71646 -85.35823" fill="none"></path><g transform="translate(167.00233,-87.511)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(110.830844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="110.830844" xlink:href="#g1-119" y="-59.247822"></use></g></g></g></g><path d="M -28.45274 -28.45274 L 24.40657 -28.45274" fill="none"></path><g transform="translate(22.30711,-28.45274)"><g stroke-dasharray="none" stroke-dashoffset="0.0"> <g stroke-linejoin="round"> <path d=" M 4.84563 0.0 L 0.96873 1.46368 L 2.24945 0.0 L 0.96873 -1.46368 Z  "></path> </g> </g></g><g transform="translate(-33.635,-26.04276)"><g stroke="#000" stroke-width="0.2" transform="scale(-1.00375,1.00375)translate(110.830844,-59.247822)scale(-1,-1)"><g fill="#000"><g stroke="#000" stroke-width="0.2"><use x="110.830844" xlink:href="#g0-47" y="-59.247822"></use><use x="116.37007" xlink:href="#g0-81" y="-59.247822"></use><use x="121.35139" xlink:href="#g0-109" y="-59.247822"></use><use x="126.890615" xlink:href="#g0-35" y="-59.247822"></use><use x="132.429856" xlink:href="#g0-72" y="-59.247822"></use><use x="135.199469" xlink:href="#g0-50" y="-59.247822"></use><use x="142.940429" xlink:href="#g0-96" y="-59.247822"></use><use x="146.845782" xlink:href="#g0-81" y="-59.247822"></use><use x="151.827102" xlink:href="#g0-105" y="-59.247822"></use><use x="155.702569" xlink:href="#g0-28" y="-59.247822"></use><use x="160.683889" xlink:href="#g0-105" y="-59.247822"></use><use x="164.559355" xlink:href="#g0-66" y="-59.247822"></use><use x="167.328968" xlink:href="#g0-81" y="-59.247822"></use><use x="172.310288" xlink:href="#g0-77" y="-59.247822"></use></g></g></g></g><path d="M -94.4092 -9.05096 L -104.0529 -18.69467" fill="none"></path><path d="M -122.86194 -37.50371 L -132.50565 -47.14742" fill="none"></path><path d="M -151.31468 -65.95645 L -160.95839 -75.60016" fill="none"></path><path d="M -133.21275 -65.95645 L -123.56905 -75.60016" fill="none"></path><path d="M -104.76001 -37.50371 L -95.1163 -47.14742" fill="none"></path><path d="M -76.30727 -9.05096 L -66.66356 -18.69467" fill="none"></path><path d="M 94.4092 -9.05096 L 104.0529 -18.69467" fill="none"></path><path d="M 122.86194 -37.50371 L 132.50565 -47.14742" fill="none"></path><path d="M 76.30727 -9.05096 L 66.66356 -18.69467" fill="none"></path><path d="M 104.76001 -37.50371 L 95.1163 -47.14742" fill="none"></path><path d="M 133.21275 -65.95645 L 123.56905 -75.60016" fill="none"></path><path d="M 151.31468 -65.95645 L 160.95839 -75.60016" fill="none"></path></g></g></g></g></g></svg></div>
<div class="arithmatex">\[\begin{align}
    \hat{c_i} &amp;= 2 + \operatorname{rank}_2(X) - \operatorname{rank}_1(X) + \operatorname{rank}_2(P) - \operatorname{rank}_1(P) + \operatorname{rank}_2(G) - \operatorname{rank}_1(G) \\
    &amp;= 2 + \operatorname{rank}_2(P) + \operatorname{rank}_2(G) - \operatorname{rank}_1(X) - \operatorname{rank}_1(P) \ (\operatorname{rank}_2(X) = \operatorname{rank}_1(G)) \\
    &amp;= 2 + \operatorname{rank}_2(P) - \operatorname{rank}_1(P) + (\operatorname{rank}_2(G) + \operatorname{rank}_1(X)) - 2\operatorname{rank}_1(X) \\
    &amp;\leqslant 2 + 2\operatorname{rank}_2(X) - 2 + (\operatorname{rank}_2(P) - \operatorname{rank}_1(P)) - 2\operatorname{rank}_1(X) \ (\text{by the lemma}) \\
    &amp;\leqslant 3(\operatorname{rank}_2(X) - \operatorname{rank}_1(X)) \ (\operatorname{rank}_2(P) - \operatorname{rank}_1(P) \leqslant \operatorname{rank}_2(X) - \operatorname{rank}_1(X))
\end{align}\]</div>
</div>
</div>
</div>
<p>所以三种操作的摊还代价都满足<span><span class="heti-spacing"> </span><span class="arithmatex">\(\hat{c_i} = &lt; 1 + 3(\operatorname{rank}_2(X) - \operatorname{rank}_1(X))\)</span></span>，接下来便是分析可能的旋转次数<span class="heti-skip"><span class="heti-spacing"> </span>.<span class="heti-spacing"> </span></span>设树的高度为<span><span class="heti-spacing"> </span><span class="arithmatex">\(h\)</span></span>，则有旋转次数 </p>
<div class="arithmatex">\[
    k = \begin{cases} h/2 &amp; h \text{ is even} \\ (h - 1)/2 + 1 &amp; h \text{ is odd} \end{cases}.
\]</div>
<p><span><span class="arithmatex">\(h\)</span><span class="heti-spacing"> </span></span>为偶数时为<span class="heti-skip"><span class="heti-spacing"> </span>Zig-Zig<span class="heti-spacing"> </span></span>或<span class="heti-skip"><span class="heti-spacing"> </span>Zig-Zag<span class="heti-spacing"> </span></span>操作，<span><span class="arithmatex">\(h\)</span><span class="heti-spacing"> </span></span>为奇数时进行<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(k - 1\)</span><span class="heti-spacing"> </span></span>次<span class="heti-skip"><span class="heti-spacing"> </span>Zig-Zig<span class="heti-spacing"> </span></span>或<span class="heti-skip"><span class="heti-spacing"> </span>Zig-Zag<span class="heti-spacing"> </span></span>操作，然后进行一次<span class="heti-skip"><span class="heti-spacing"> </span>Zig<span class="heti-spacing"> </span></span>操作<span class="heti-skip"><span class="heti-spacing"> </span>.<span class="heti-spacing"> </span></span>所以最坏上界放缩为<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(k\)</span><span class="heti-spacing"> </span></span>次<span class="heti-skip"><span class="heti-spacing"> </span>Zig-Zig<span class="heti-spacing"> </span></span>或<span class="heti-skip"><span class="heti-spacing"> </span>Zig-Zag<span class="heti-spacing"> </span></span>操作，以及最后一次<span class="heti-skip"><span class="heti-spacing"> </span>Zig<span class="heti-spacing"> </span></span>操作<span class="heti-skip"><span class="heti-spacing"> </span>.<span class="heti-spacing"> </span></span>所以摊还代价求和为</p>
<div class="arithmatex">\[\begin{align}
    \sum_{i = 1}^{k + 1} \hat{c_i} &amp;\leqslant 1 + 3(\operatorname{rank}_{k + 1}(X) - \operatorname{rank}_k(X)) + \sum_{i = 1}^k 3(\operatorname{rank}_i(X) - \operatorname{rank}_{i - 1}(X)) \\
    &amp;= 1 + 3(\operatorname{rank}_{k + 1}(X) - \operatorname{rank}_0(X)) = O(\log n).
\end{align}\]</div>
<p>所以最后总结出<span class="heti-skip"><span class="heti-spacing"> </span>Splay<span class="heti-spacing"> </span></span>树的搜索、插入和删除操作的摊还复杂度均为<span><span class="heti-spacing"> </span><span class="arithmatex">\(O(\log n)\)</span>.</span></p>
</article>
</div>
</div>
<a class="md-top md-icon" data-md-component="top" hidden="" href="#">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg>
            回到页面顶部
          </a>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "navigation.tracking", "navigation.tabs", "navigation.indexes", "navigation.top"], "search": "../../assets/javascripts/workers/search.e5c33ebb.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
<script src="../../assets/javascripts/bundle.ba449ae6.min.js"></script>
<script src="../../javascripts/mathjax.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>